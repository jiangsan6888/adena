<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¸¸æˆäº¤æ˜“ - æ¸¸æˆå¸ã€é“å…·ã€è´¦å·äº¤æ˜“å¹³å°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Microsoft YaHei', 'Malgun Gothic', sans-serif;
            background: #f5f7fa;
            color: #333;
            font-size: 14px;
            line-height: 1.5;
        }

        header {
            background: white;
            position: relative;
            z-index: 1000;
        }

        /* æœ€ä¸Šæ–¹æ¨ªå¹…å›¾æ¡ˆ - ä½¿ç”¨AIONä¸»é¢˜æ¨ªå¹… */
        .top-banner {
            width: 100%;
            padding: 0;
            margin: 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .top-banner img {
            width: 100%;
            height: auto;
            display: block;
        }

        /* å¯¼èˆªæ  */
        .navbar {
            background: white;
            padding: 15px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
            color: #6952EB;
        }

        .nav-menu {
            display: flex;
            list-style: none;
        }

        .nav-item {
            margin-left: 30px;
        }

        .nav-link {
            text-decoration: none;
            color: #333;
            font-weight: 500;
            transition: color 0.3s;
        }

        .nav-link:hover {
            color: #6952EB;
        }

        /* ä¸»å®¹å™¨ */
        .container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
        }

        /* æ¸¸æˆé€‰æ‹©ç•Œé¢æ ·å¼ */
        .game-selection {
            background: #f8fafc;
            min-height: 70vh;
            display: flex;
            align-items: center;
            padding: 40px 0;
            position: relative;
        }

        .game-selection-title {
            text-align: center;
            color: #1e293b;
            font-size: 36px;
            font-weight: bold;
            margin-bottom: 40px;
            text-shadow: none;
            font-family: 'Malgun Gothic', sans-serif;
        }

        .game-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 25px;
            margin-top: 30px;
            max-width: 1000px;
            margin-left: auto;
            margin-right: auto;
            width: 100%;
        }

        .game-card {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: auto;
            padding: 20px;
            border: 1px solid #e2e8f0;
        }

        .game-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(79, 70, 229, 0.15);
            border-color: #4f46e5;
        }

        .game-image {
            width: 120px;
            height: 120px;
            overflow: hidden;
            margin: 0 0 15px 0;
            border-radius: 8px;
            background: #f1f5f9;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid #e2e8f0;
        }

        .game-image img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .game-name {
            font-size: 18px;
            font-weight: 600;
            color: #1e293b;
            text-align: center;
            margin-top: 10px;
        }

        /* å¯¼èˆªæŒ‰é’® */
        .nav-buttons {
            position: absolute;
            top: 20px;
            left: 20px;
            display: flex;
            gap: 10px;
        }

        .nav-btn {
            background: rgba(255, 255, 255, 0.9);
            color: #4f46e5;
            padding: 8px 16px;
            border-radius: 20px;
            text-decoration: none;
            font-weight: 500;
            font-size: 14px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            transition: all 0.3s;
        }

        .nav-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        /* è¿‡æ»¤éƒ¨åˆ† */
        .filter-section {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
        }

        .filter-row {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .filter-row:last-child {
            margin-bottom: 0;
        }

        .filter-label {
            width: 100px;
            font-weight: 500;
            color: #333;
        }

        .filter-options {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .filter-option {
            padding: 8px 16px;
            background: #f5f7fa;
            border: 1px solid #e2e8f0;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
        }

        .filter-option:hover {
            background: #e2e8f0;
        }

        .filter-option.active {
            background: #6952EB;
            color: white;
            border-color: #6952EB;
        }

        /* å•†å“åˆ—è¡¨ */
        .product-section {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
        }

        .section-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 20px;
            color: #333;
        }

        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }

        .product-card {
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 15px;
            transition: all 0.3s;
        }

        .product-card:hover {
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }

        .product-name {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
        }

        .product-info {
            font-size: 14px;
            color: #666;
            margin-bottom: 5px;
        }

        .product-price {
            font-size: 18px;
            font-weight: bold;
            color: #ff4757;
            margin-top: 10px;
        }

        /* æ¨èäº§å“è¡¨æ ¼ */
        .recommended-section {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
        }

        .recommended-table {
            width: 100%;
            border-collapse: collapse;
        }

        .recommended-table th,
        .recommended-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }

        .recommended-table th {
            background: #f8fafc;
            font-weight: bold;
            color: #333;
        }

        /* æ¨¡æ€æ¡† */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.5);
        }

        .modal-content {
            background-color: white;
            margin: 10% auto;
            padding: 20px;
            border: 1px solid #888;
            border-radius: 8px;
            width: 90%;
            max-width: 500px;
            position: relative;
        }

        .modal-close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            position: absolute;
            right: 10px;
            top: 5px;
        }

        .modal-close:hover {
            color: black;
        }

        .modal-title {
            text-align: center;
            margin-bottom: 20px;
            color: #333;
        }

        /* è¡¨å•æ ·å¼ */
        .form-group {
            margin-bottom: 15px;
        }

        .form-label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #333;
        }

        .form-input {
            width: 100%;
            padding: 10px;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
            font-size: 14px;
        }

        .form-input:focus {
            outline: none;
            border-color: #6952EB;
        }

        .form-submit {
            width: 100%;
            padding: 12px;
            background: #6952EB;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .form-submit:hover {
            background: #5a46d4;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 5px;
            cursor: pointer;
        }

        .form-footer {
            text-align: center;
            margin-top: 20px;
            font-size: 14px;
        }

        .form-footer a {
            color: #6952EB;
            text-decoration: none;
        }

        .form-footer a:hover {
            text-decoration: underline;
        }

        .error-message {
            color: #ff4757;
            font-size: 12px;
            margin-top: 5px;
            display: none;
        }

        /* é¡µè„š */
        /* èƒŒæ™¯éŸ³ä¹æ§åˆ¶ */
        .music-controls {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }
        
        .music-btn {
            background: rgba(105, 82, 235, 0.8);
            color: white;
            border: none;
            padding: 5px 7.5px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 7px;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
        }
        
        .music-btn:hover {
            background: rgba(105, 82, 235, 1);
            transform: scale(1.05);
        }
        
        /* æ¨ªå¹…æ»šåŠ¨é€šçŸ¥æ ·å¼ */
        .top-banner {
            position: relative;
        }
        
        .banner-marquee {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            background: rgba(0, 0, 0, 0.6);
            color: white;
            padding: 8px 0;
            overflow: hidden;
            white-space: nowrap;
            z-index: 10;
        }
        
        .banner-marquee-content {
            display: inline-block;
            animation: marquee 20s linear infinite;
            padding: 0 20px;
        }
        
        @keyframes marquee {
            0% {
                transform: translateX(100%);
            }
            100% {
                transform: translateX(-100%);
            }
        }
        
        /* å¹¿å‘Šå®¹å™¨æ ·å¼ */
        .advertisement-container {
            background: white;
            padding: 20px;
            margin: 20px auto;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            max-width: 1200px;
            white-space: nowrap;
            overflow-x: hidden;
            overflow-y: hidden;
            position: relative;
        }
        
        /* å¹¿å‘Šæ»šåŠ¨å†…å®¹æ ·å¼ */
        .advertisement-scroll-content {
            display: flex;
            gap: 20px;
            overflow-x: auto;
            overflow-y: hidden;
            padding-bottom: 10px;
            -webkit-overflow-scrolling: touch;
        }
        
        /* éšè—æ»šåŠ¨æ¡ä½†ä¿æŒæ»šåŠ¨åŠŸèƒ½ */
        .advertisement-scroll-content::-webkit-scrollbar {
            height: 8px;
        }
        
        .advertisement-scroll-content::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        
        .advertisement-scroll-content::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }
        
        .advertisement-scroll-content::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        
        /* å¹¿å‘Šæ»šåŠ¨æ§åˆ¶æŒ‰é’® */
        .ad-scroll-controls {
            position: absolute;
            bottom: 10px;
            right: 20px;
            display: flex;
            gap: 10px;
            z-index: 10;
        }
        
        .ad-scroll-btn {
            background: rgba(0, 0, 0, 0.6);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: background 0.3s;
        }
        
        .ad-scroll-btn:hover {
            background: rgba(0, 0, 0, 0.8);
        }
        
        /* å¹¿å‘Šå®¹å™¨æ¨ªå‘æ»šåŠ¨æ¡æ ·å¼ */
        .advertisement-container::-webkit-scrollbar {
            height: 8px;
        }
        
        .advertisement-container::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        
        .advertisement-container::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }
        
        .advertisement-container::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        
        .advertisement-item {
            display: inline-flex;
            align-items: center;
            gap: 20px;
            padding: 15px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            animation: slideIn 0.5s ease-in-out;
            min-height: 120px;
            min-width: 250px;
            max-width: 350px;
            white-space: normal;
            vertical-align: top;
            background: #f8fafc;
        }
        
        .advertisement-image {
            width: 100px;
            height: 100px;
            object-fit: cover;
            border-radius: 8px;
        }
        
        .advertisement-info {
            flex: 1;
        }
        
        .advertisement-title {
            font-size: 18px;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }
        
        .advertisement-text {
            color: #666;
            font-size: 14px;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        footer {
            background: white;
            text-align: center;
            padding: 20px 0;
            margin-top: 40px;
            border-top: 1px solid #e2e8f0;
        }

        /* ç»Ÿè®¡ä¿¡æ¯ */
        .stats-section {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }

        .stat-card {
            text-align: center;
            padding: 20px;
            background: #f8fafc;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
        }

        .stat-number {
            font-size: 32px;
            font-weight: bold;
            color: #6952EB;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #666;
            font-size: 14px;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            /* å¯¼èˆªæ  */
            .nav-container {
                flex-direction: column;
                gap: 10px;
            }

            .nav-menu {
                margin-top: 10px;
                gap: 15px;
            }

            /* è¿‡æ»¤éƒ¨åˆ† */
            .filter-row {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }

            .filter-label {
                width: auto;
            }

            /* å•†å“åˆ—è¡¨ */
            .product-grid {
                grid-template-columns: 1fr;
            }

            /* ç»Ÿè®¡ä¿¡æ¯ */
            .stats-grid {
                grid-template-columns: 1fr;
            }

            /* æ¸¸æˆé€‰æ‹©ç•Œé¢ - å‚è€ƒ itembay ç§»åŠ¨ç«¯é€‚é… */
            .game-selection-title {
                font-size: 28px;
                margin-bottom: 30px;
            }

            .game-grid {
                grid-template-columns: 1fr;
                gap: 20px;
                max-width: 100%;
                padding: 0 20px;
            }

            .game-card {
                flex-direction: column;
                height: auto;
                text-align: center;
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <!-- èƒŒæ™¯éŸ³ä¹ -->
    <audio id="backgroundMusic" loop preload="auto" volume="0.2">
        <source src="aionèƒŒæ™¯éŸ³ä¹.mp3" type="audio/mpeg">
        æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒéŸ³é¢‘å…ƒç´ ã€‚
    </audio>
    
    <!-- èƒŒæ™¯éŸ³ä¹æ§åˆ¶æŒ‰é’® -->
    <div class="music-controls">
        <button id="musicToggle" class="music-btn">ğŸ”Š èƒŒæ™¯éŸ³ä¹</button>
    </div>
    
    <!-- æœ€ä¸Šæ–¹æ¨ªå¹…å›¾æ¡ˆ -->
    <div class="top-banner">
        <img src="img/é¦–é¡µèƒŒæ™¯æ¡.jpg" alt="æ¸¸æˆäº¤æ˜“å¹³å°æ¨ªå¹…">
        <!-- æ»šåŠ¨é€šçŸ¥å†…å®¹ -->
        <div class="banner-marquee" id="bannerMarquee">
            <div class="banner-marquee-content" id="marqueeContent">
                <!-- åŠ¨æ€ç”Ÿæˆæ»šåŠ¨é€šçŸ¥å†…å®¹ -->
            </div>
        </div>
    </div>

    <!-- å¯¼èˆªæ  -->
    <header>
        <div class="nav-container">
            <div class="logo">ì•„ì´í…œê±°ë˜ì‚¬ì´íŠ¸-ybabc</div>
            <ul class="nav-menu">
                <li class="nav-item"><a href="#" class="nav-link">é¦–é¡µ</a></li>
                <li class="nav-item"><a href="#" class="nav-link">å‡ºå”®</a></li>
                <li class="nav-item"><a href="#" class="nav-link">æ±‚è´­</a></li>
                <li class="nav-item"><a href="#" class="nav-link">æˆ‘çš„äº¤æ˜“</a></li>
                <li class="nav-item"><a href="#" class="nav-link" id="loginBtn">ç™»å½•</a></li>
            </ul>
        </div>
    </header>

    <!-- æ¸¸æˆé€‰æ‹©ç•Œé¢ -->
    <div class="game-selection" id="gameSelection">
        <div class="container">
            <h1 class="game-selection-title">ê²Œì„ ì„ íƒ</h1>
            <div class="game-grid" id="gameGrid">
                <!-- åŠ¨æ€ç”Ÿæˆæ¸¸æˆç§ç±» -->
            </div>
        </div>
    </div>

    <!-- äº¤æ˜“å¹³å°ç•Œé¢ -->
    <div class="container" id="mainContainer" style="display: none;">
        <div class="filter-section">
            <div class="filter-row">
                <div class="filter-label">äº¤æ˜“ç±»å‹</div>
                <div class="filter-options">
                    <div class="filter-option active">å‡ºå”®</div>
                    <div class="filter-option">æ±‚è´­</div>
                </div>
            </div>
            <div class="filter-row">
                <div class="filter-label">å•†å“ç±»å‹</div>
                <div class="filter-options">
                    <div class="filter-option active">å…¨éƒ¨</div>
                    <div class="filter-option">æ¸¸æˆå¸</div>
                    <div class="filter-option">é“å…·</div>
                    <div class="filter-option">è´¦å·</div>
                    <div class="filter-option">å…¶ä»–</div>
                </div>
            </div>
            <div class="filter-row">
                <div class="filter-label">äº¤æ˜“çŠ¶æ€</div>
                <div class="filter-options">
                    <div class="filter-option active">å¯äº¤æ˜“å•†å“</div>
                    <div class="filter-option">å·²å®Œæˆäº¤æ˜“</div>
                </div>
            </div>
        </div>

        <!-- æ¨èäº§å“ -->
        <div class="recommended-section">
            <h2 class="section-title">æ¨èäº§å“</h2>
            
            <!-- ç®¡ç†å‘˜æ·»åŠ å•†å“è¡¨å• -->
            <div id="addProductForm" style="margin-bottom: 20px; padding: 20px; background: #f8fafc; border-radius: 8px; display: none;">
                <h3>æ·»åŠ æ–°å•†å“</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 15px;">
                    <div>
                        <label>å•†å“åç§°ï¼š</label>
                        <input type="text" id="newProductName" style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #e2e8f0; border-radius: 4px;" placeholder="è¾“å…¥å•†å“åç§°">
                    </div>
                    <div>
                        <label>æœåŠ¡å™¨åç§°ï¼š</label>
                        <input type="text" id="newProductServer" style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #e2e8f0; border-radius: 4px;" placeholder="è¾“å…¥æœåŠ¡å™¨åç§°">
                    </div>
                    <div>
                        <label>åˆ†ç±»åç§°ï¼š</label>
                        <input type="text" id="newProductCategory" style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #e2e8f0; border-radius: 4px;" placeholder="è¾“å…¥åˆ†ç±»åç§°">
                    </div>
                    <div>
                        <label>å•ä½ï¼š</label>
                        <input type="text" id="newProductUnit" style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #e2e8f0; border-radius: 4px;" placeholder="è¾“å…¥å•ä½">
                    </div>
                    <div>
                        <label>ä»·æ ¼ï¼š</label>
                        <input type="number" id="newProductPrice" style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #e2e8f0; border-radius: 4px;" placeholder="è¾“å…¥ä»·æ ¼" min="0" step="0.01">
                    </div>
                    <div>
                        <label>åº“å­˜ï¼š</label>
                        <input type="number" id="newProductStock" style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #e2e8f0; border-radius: 4px;" placeholder="è¾“å…¥åº“å­˜" min="0">
                    </div>
                    <div>
                        <label>å–å®¶ï¼š</label>
                        <input type="text" id="newProductSeller" style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #e2e8f0; border-radius: 4px;" placeholder="è¾“å…¥å–å®¶åç§°">
                    </div>
                </div>
                <div style="display: flex; gap: 10px;">
                    <button type="button" onclick="addNewProduct()" class="form-submit" style="width: auto; padding: 8px 16px; background: #10b981;">æ·»åŠ å•†å“</button>
                    <button type="button" onclick="toggleAddProductForm()" class="form-submit" style="width: auto; padding: 8px 16px; background: #6b7280;">å–æ¶ˆ</button>
                </div>
            </div>
            
            <!-- ç®¡ç†å‘˜æ§åˆ¶æŒ‰é’® -->
            <div id="adminControls" style="margin-bottom: 15px;">
                <!-- åŠ¨æ€ç”Ÿæˆ -->
            </div>
            
            <table class="recommended-table">
                <thead>
                    <tr>
                        <th>å•†å“åç§°</th>
                        <th>æœåŠ¡å™¨</th>
                        <th>å•ä½</th>
                        <th>åº“å­˜</th>
                        <th>æ“ä½œ</th>
                    </tr>
                </thead>
                <tbody id="recommendedTableBody">
                    <!-- åŠ¨æ€ç”Ÿæˆæ¨èäº§å“ -->
                </tbody>
            </table>
        </div>

        <!-- å•†å“åˆ—è¡¨ -->
        <div class="product-section">
            <h2 class="section-title">å…¨éƒ¨å•†å“</h2>
            <div class="product-grid" id="productGrid">
                <!-- åŠ¨æ€ç”Ÿæˆå•†å“åˆ—è¡¨ -->
            </div>
        </div>
    </div>

    <!-- ç™»å½•æ¨¡æ€æ¡† -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <button class="modal-close" id="closeLogin">&times;</button>
            <h2 class="modal-title">ç”¨æˆ·ç™»å½•</h2>
            <form id="loginForm">
                <div class="form-group">
                    <label class="form-label">ç”¨æˆ·å</label>
                    <input type="text" class="form-input" id="username" placeholder="è¯·è¾“å…¥ç”¨æˆ·å">
                    <div class="error-message" id="usernameError">ç”¨æˆ·åæ ¼å¼ä¸æ­£ç¡®</div>
                </div>
                <div class="form-group">
                    <label class="form-label">å¯†ç </label>
                    <input type="password" class="form-input" id="password" placeholder="è¯·è¾“å…¥å¯†ç ">
                    <div class="error-message" id="passwordError">å¯†ç æ ¼å¼ä¸æ­£ç¡®</div>
                </div>
                <!-- å£ä»¤å¯†ç è¾“å…¥æ¡†ï¼Œé»˜è®¤éšè—ï¼Œä»…å½“adminç™»å½•3æ¬¡é”™è¯¯åæ˜¾ç¤º -->
                <div class="form-group" id="passphraseGroup" style="display: none;">
                    <label class="form-label">æˆ–ä½¿ç”¨å£ä»¤å¯†ç </label>
                    <input type="password" class="form-input" id="loginPassphrase" placeholder="è¯·è¾“å…¥å£ä»¤å¯†ç ">
                    <div class="error-message" id="passphraseError">å£ä»¤å¯†ç ä¸æ­£ç¡®</div>
                </div>
                <div class="form-group">
                    <label class="checkbox-group">
                        <input type="checkbox" id="rememberMe">
                        <span>è®°ä½æˆ‘</span>
                    </label>
                </div>
                <button type="submit" class="form-submit">ç™»å½•</button>
            </form>
            <div class="form-footer">
                è¿˜æ²¡æœ‰è´¦å·ï¼Ÿ<a id="switchToRegister">ç«‹å³æ³¨å†Œ</a><br>
                <a href="#">å¿˜è®°å¯†ç ï¼Ÿ</a>
            </div>
        </div>
    </div>

    <!-- æ³¨å†Œæ¨¡æ€æ¡† -->
    <div class="modal" id="registerModal">
        <div class="modal-content">
            <button class="modal-close" id="closeRegister">&times;</button>
            <h2 class="modal-title">ä¼šå‘˜æ³¨å†Œ</h2>
            <form id="registerForm">
                <div class="form-group">
                    <label class="form-label">ç”¨æˆ·å</label>
                    <input type="text" class="form-input" id="regUsername" placeholder="è¯·è¾“å…¥ç”¨æˆ·åï¼ˆ3-20ä¸ªå­—ç¬¦ï¼‰">
                    <div class="error-message" id="regUsernameError">ç”¨æˆ·åæ ¼å¼ä¸æ­£ç¡®</div>
                </div>
                <div class="form-group">
                    <label class="form-label">æ‰‹æœºå·ç </label>
                    <input type="tel" class="form-input" id="regPhone" placeholder="è¯·è¾“å…¥æ‰‹æœºå·ç ">
                    <div class="error-message" id="regPhoneError">è¯·è¾“å…¥æœ‰æ•ˆçš„æ‰‹æœºå·ç </div>
                </div>
                <div class="form-group">
                    <label class="form-label">å¯†ç </label>
                    <input type="password" class="form-input" id="regPassword" placeholder="è¯·è¾“å…¥å¯†ç ï¼ˆè‡³å°‘6ä¸ªå­—ç¬¦ï¼‰">
                    <div class="error-message" id="regPasswordError">å¯†ç è‡³å°‘éœ€è¦6ä¸ªå­—ç¬¦</div>
                </div>
                <div class="form-group">
                    <label class="form-label">ç¡®è®¤å¯†ç </label>
                    <input type="password" class="form-input" id="regConfirmPassword" placeholder="è¯·å†æ¬¡è¾“å…¥å¯†ç ">
                    <div class="error-message" id="regConfirmPasswordError">ä¸¤æ¬¡è¾“å…¥çš„å¯†ç ä¸ä¸€è‡´</div>
                </div>
                <div class="form-group">
                    <label class="checkbox-group">
                        <input type="checkbox" id="agreeTerms">
                        <span>æˆ‘å·²é˜…è¯»å¹¶åŒæ„<a href="#" style="color: #6952EB;">æœåŠ¡æ¡æ¬¾</a>å’Œ<a href="#" style="color: #6952EB;">éšç§æ”¿ç­–</a></span>
                    </label>
                    <div class="error-message" id="agreeTermsError">è¯·åŒæ„æœåŠ¡æ¡æ¬¾</div>
                </div>
                <button type="submit" class="form-submit">æ³¨å†Œ</button>
            </form>
            <div class="form-footer">
                å·²æœ‰è´¦å·ï¼Ÿ<a id="switchToLogin">ç«‹å³ç™»å½•</a>
            </div>
        </div>
    </div>

    <!-- ç®¡ç†å‘˜åå° -->
    <div class="modal" id="adminModal" style="display: none; z-index: 3000;">
        <div class="modal-content" style="width: 90%; max-width: 1000px; margin: 5% auto;">
            <button class="modal-close" id="closeAdminModal">&times;</button>
            <h2 class="modal-title">ç®¡ç†åå°</h2>
            
            <!-- ç®¡ç†åå°å¯¼èˆª -->
            <div class="admin-nav" style="margin-bottom: 20px; border-bottom: 1px solid #e2e8f0; padding-bottom: 10px;">
                <button class="admin-nav-btn active" onclick="showAdminSection('games')">æ¸¸æˆç®¡ç†</button>
                <button class="admin-nav-btn" onclick="showAdminSection('products')">å•†å“ç®¡ç†</button>
                <button class="admin-nav-btn" onclick="showAdminSection('users')">ç”¨æˆ·ç®¡ç†</button>
                <button class="admin-nav-btn" onclick="showAdminSection('notifications')">æ»šåŠ¨é€šçŸ¥ç®¡ç†</button>
                <button class="admin-nav-btn" onclick="showAdminSection('advertisements')">å¹¿å‘Šç®¡ç†</button>
                <button class="admin-nav-btn" onclick="showAdminSection('data')">æ•°æ®ç®¡ç†</button>
                <button class="admin-nav-btn" onclick="showAdminSection('profile')">ä¸ªäººè®¾ç½®</button>
            </div>
            
            <!-- æ¸¸æˆç®¡ç† -->
            <div id="gamesSection" class="admin-section">
                <h3>æ¸¸æˆç®¡ç†</h3>
                <div class="admin-form" style="margin-bottom: 20px; padding: 20px; background: #f8fafc; border-radius: 8px;">
                    <h4>æ·»åŠ /ç¼–è¾‘æ¸¸æˆ</h4>
                    <form id="gameForm">
                        <input type="hidden" id="gameId">
                        <input type="hidden" id="gameImageUrl">
                        <div style="display: flex; gap: 10px; margin-bottom: 10px; flex-wrap: wrap;">
                            <div style="flex: 1; min-width: 200px;">
                                <label>æ¸¸æˆåç§°ï¼š</label>
                                <input type="text" id="gameName" style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #e2e8f0; border-radius: 4px;">
                            </div>
                            <div style="flex: 1; min-width: 200px;">
                                <label>æ¸¸æˆå›¾æ ‡ï¼š</label>
                                <input type="file" id="gameImageFile" accept="image/*" style="width: 100%; padding: 8px; margin-top: 5px;">
                                <div style="margin-top: 10px; display: none;" id="gameImagePreviewContainer">
                                    <img id="gameImagePreview" style="max-width: 100px; max-height: 100px; border-radius: 4px; object-fit: contain;">
                                </div>
                            </div>
                            <div style="display: flex; align-items: flex-end; gap: 10px;">
                                <button type="submit" class="form-submit" style="width: auto; padding: 8px 16px;">ä¿å­˜æ¸¸æˆ</button>
                                <button type="button" id="cancelGameEdit" class="form-submit" style="width: auto; padding: 8px 16px; background: #6b7280;" onclick="cancelGameEdit()">å–æ¶ˆ</button>
                            </div>
                        </div>
                    </form>
                </div>
                
                <!-- æ¸¸æˆåˆ—è¡¨ -->
                <div class="admin-list">
                    <h4>æ¸¸æˆåˆ—è¡¨</h4>
                    <table style="width: 100%; border-collapse: collapse; margin-top: 10px;">
                        <thead>
                            <tr style="background: #f8fafc;">
                                <th style="padding: 10px; text-align: left; border-bottom: 1px solid #e2e8f0;">ID</th>
                                <th style="padding: 10px; text-align: left; border-bottom: 1px solid #e2e8f0;">æ¸¸æˆåç§°</th>
                                <th style="padding: 10px; text-align: left; border-bottom: 1px solid #e2e8f0;">å›¾æ ‡</th>
                                <th style="padding: 10px; text-align: left; border-bottom: 1px solid #e2e8f0;">æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody id="gamesList">
                            <!-- åŠ¨æ€ç”Ÿæˆæ¸¸æˆåˆ—è¡¨ -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- å•†å“ç®¡ç† -->
            <div id="productsSection" class="admin-section" style="display: none;">
                <h3>å•†å“ç®¡ç†</h3>
                <div class="admin-form" style="margin-bottom: 20px; padding: 20px; background: #f8fafc; border-radius: 8px;">
                    <h4>æ·»åŠ /ç¼–è¾‘å•†å“</h4>
                    <form id="productForm">
                        <input type="hidden" id="productId">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 15px;">
                            <div>
                                <label>æ‰€å±æ¸¸æˆï¼š</label>
                                <select id="productGameId" style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #e2e8f0; border-radius: 4px;">
                                    <!-- åŠ¨æ€ç”Ÿæˆæ¸¸æˆé€‰é¡¹ -->
                                </select>
                            </div>
                            <div>
                                <label>å•†å“åç§°ï¼š</label>
                                <input type="text" id="productName" style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #e2e8f0; border-radius: 4px;">
                            </div>
                            <div>
                                <label>æœåŠ¡å™¨åç§°ï¼š</label>
                                <input type="text" id="productServer" style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #e2e8f0; border-radius: 4px;">
                            </div>
                            <div>
                                <label>åˆ†ç±»åç§°ï¼š</label>
                                <input type="text" id="productCategory" style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #e2e8f0; border-radius: 4px;">
                            </div>
                            <div>
                                <label>å•ä½ï¼š</label>
                                <input type="text" id="productUnit" style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #e2e8f0; border-radius: 4px;" placeholder="å¦‚ï¼šä¸ªã€ä»¶ã€ç»„ç­‰">
                            </div>
                            <div>
                                <label>ä»·æ ¼ï¼š</label>
                                <input type="number" id="productPrice" style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #e2e8f0; border-radius: 4px;" min="0" step="0.01">
                            </div>
                            <div>
                                <label>åº“å­˜ï¼š</label>
                                <input type="number" id="productStock" style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #e2e8f0; border-radius: 4px;" min="0">
                            </div>
                            <div>
                                <label>å–å®¶ï¼š</label>
                                <input type="text" id="productSeller" style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #e2e8f0; border-radius: 4px;">
                            </div>
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button type="submit" class="form-submit" style="width: auto; padding: 8px 16px;">ä¿å­˜å•†å“</button>
                            <button type="button" id="cancelProductEdit" class="form-submit" style="width: auto; padding: 8px 16px; background: #6b7280;" onclick="cancelProductEdit()">å–æ¶ˆ</button>
                        </div>
                    </form>
                </div>
                
                <!-- å•†å“åˆ—è¡¨ -->
                <div class="admin-list">
                    <h4>å•†å“åˆ—è¡¨</h4>
                    <table style="width: 100%; border-collapse: collapse; margin-top: 10px;">
                        <thead>
                        <tr style="background: #f8fafc;">
                            <th style="padding: 10px; text-align: left; border-bottom: 1px solid #e2e8f0;">ID</th>
                            <th style="padding: 10px; text-align: left; border-bottom: 1px solid #e2e8f0;">å•†å“åç§°</th>
                            <th style="padding: 10px; text-align: left; border-bottom: 1px solid #e2e8f0;">æ‰€å±æ¸¸æˆ</th>
                            <th style="padding: 10px; text-align: left; border-bottom: 1px solid #e2e8f0;">æœåŠ¡å™¨</th>
                            <th style="padding: 10px; text-align: left; border-bottom: 1px solid #e2e8f0;">åˆ†ç±»åç§°</th>
                            <th style="padding: 10px; text-align: left; border-bottom: 1px solid #e2e8f0;">å•ä½</th>
                            <th style="padding: 10px; text-align: left; border-bottom: 1px solid #e2e8f0;">ä»·æ ¼</th>
                            <th style="padding: 10px; text-align: left; border-bottom: 1px solid #e2e8f0;">åº“å­˜</th>
                            <th style="padding: 10px; text-align: left; border-bottom: 1px solid #e2e8f0;">å–å®¶</th>
                            <th style="padding: 10px; text-align: left; border-bottom: 1px solid #e2e8f0;">æ“ä½œ</th>
                        </tr>
                    </thead>
                        <tbody id="productsList">
                            <!-- åŠ¨æ€ç”Ÿæˆå•†å“åˆ—è¡¨ -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- ç”¨æˆ·ç®¡ç† -->
            <div id="usersSection" class="admin-section" style="display: none;">
                <h3>ç”¨æˆ·ç®¡ç†</h3>
                <div class="admin-list">
                    <h4>ç”¨æˆ·åˆ—è¡¨</h4>
                    <table style="width: 100%; border-collapse: collapse; margin-top: 10px;">
                        <thead>
                            <tr style="background: #f8fafc;">
                                <th style="padding: 10px; text-align: left; border-bottom: 1px solid #e2e8f0;">ç”¨æˆ·å</th>
                                <th style="padding: 10px; text-align: left; border-bottom: 1px solid #e2e8f0;">ç”µè¯å·ç </th>
                                <th style="padding: 10px; text-align: left; border-bottom: 1px solid #e2e8f0;">é‚®ç®±</th>
                                <th style="padding: 10px; text-align: left; border-bottom: 1px solid #e2e8f0;">æ³¨å†Œæ—¥æœŸ</th>
                                <th style="padding: 10px; text-align: left; border-bottom: 1px solid #e2e8f0;">ç®¡ç†å‘˜</th>
                            </tr>
                        </thead>
                        <tbody id="usersList">
                            <!-- åŠ¨æ€ç”Ÿæˆç”¨æˆ·åˆ—è¡¨ -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- æ»šåŠ¨é€šçŸ¥ç®¡ç† -->
            <div id="notificationsSection" class="admin-section" style="display: none;">
                <h3>æ»šåŠ¨é€šçŸ¥ç®¡ç†</h3>
                <div class="admin-form" style="margin-bottom: 20px; padding: 20px; background: #f8fafc; border-radius: 8px;">
                    <h4>æ·»åŠ /ç¼–è¾‘æ»šåŠ¨é€šçŸ¥</h4>
                    <form id="notificationForm">
                        <input type="hidden" id="notificationId">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 15px;">
                            <div>
                                <label>é€šçŸ¥å†…å®¹ï¼š</label>
                                <input type="text" id="notificationContent" style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #e2e8f0; border-radius: 4px;" placeholder="è¯·è¾“å…¥æ»šåŠ¨é€šçŸ¥å†…å®¹">
                            </div>
                            <div>
                                <label>æ˜¯å¦å¯ç”¨ï¼š</label>
                                <select id="notificationEnabled" style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #e2e8f0; border-radius: 4px;">
                                    <option value="true">å¯ç”¨</option>
                                    <option value="false">ç¦ç”¨</option>
                                </select>
                            </div>
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button type="submit" class="form-submit" style="width: auto; padding: 8px 16px;">ä¿å­˜é€šçŸ¥</button>
                            <button type="button" id="cancelNotificationEdit" class="form-submit" style="width: auto; padding: 8px 16px; background: #6b7280;" onclick="cancelNotificationEdit()">å–æ¶ˆ</button>
                        </div>
                    </form>
                </div>
                
                <!-- æ»šåŠ¨é€šçŸ¥åˆ—è¡¨ -->
                <div class="admin-list">
                    <h4>æ»šåŠ¨é€šçŸ¥åˆ—è¡¨</h4>
                    <table style="width: 100%; border-collapse: collapse; margin-top: 10px;">
                        <thead>
                            <tr style="background: #f8fafc;">
                                <th style="padding: 10px; text-align: left; border-bottom: 1px solid #e2e8f0;">ID</th>
                                <th style="padding: 10px; text-align: left; border-bottom: 1px solid #e2e8f0;">é€šçŸ¥å†…å®¹</th>
                                <th style="padding: 10px; text-align: left; border-bottom: 1px solid #e2e8f0;">çŠ¶æ€</th>
                                <th style="padding: 10px; text-align: left; border-bottom: 1px solid #e2e8f0;">æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody id="notificationsList">
                            <!-- åŠ¨æ€ç”Ÿæˆæ»šåŠ¨é€šçŸ¥åˆ—è¡¨ -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- å¹¿å‘Šç®¡ç† -->
            <div id="advertisementsSection" class="admin-section" style="display: none;">
                <h3>å¹¿å‘Šç®¡ç†</h3>
                <div class="admin-form" style="margin-bottom: 20px; padding: 20px; background: #f8fafc; border-radius: 8px;">
                    <h4>æ·»åŠ /ç¼–è¾‘å¹¿å‘Š</h4>
                    <form id="advertisementForm">
                        <input type="hidden" id="advertisementId">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 15px;">
                            <div>
                                <label>å¹¿å‘Šæ ‡é¢˜ï¼š</label>
                                <input type="text" id="advertisementTitle" style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #e2e8f0; border-radius: 4px;" placeholder="è¯·è¾“å…¥å¹¿å‘Šæ ‡é¢˜">
                            </div>
                            <div>
                                <label>å¹¿å‘Šå†…å®¹ï¼š</label>
                                <textarea id="advertisementContent" style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #e2e8f0; border-radius: 4px; height: 80px;" placeholder="è¯·è¾“å…¥å¹¿å‘Šå†…å®¹"></textarea>
                            </div>
                            <div>
                                <label>å¹¿å‘Šå›¾ç‰‡ï¼š</label>
                                <input type="file" id="advertisementImageFile" accept="image/*" style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #e2e8f0; border-radius: 4px;">
                                <input type="hidden" id="advertisementImage">
                                <div style="margin-top: 10px; display: none;" id="imagePreviewContainer">
                                    <img id="imagePreview" style="max-width: 150px; max-height: 150px; border-radius: 4px;">
                                </div>
                            </div>
                            <div>
                                <label>æ˜¯å¦å¯ç”¨ï¼š</label>
                                <select id="advertisementEnabled" style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #e2e8f0; border-radius: 4px;">
                                    <option value="true">å¯ç”¨</option>
                                    <option value="false">ç¦ç”¨</option>
                                </select>
                            </div>
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button type="submit" class="form-submit" style="width: auto; padding: 8px 16px;">ä¿å­˜å¹¿å‘Š</button>
                            <button type="button" id="cancelAdvertisementEdit" class="form-submit" style="width: auto; padding: 8px 16px; background: #6b7280;" onclick="cancelAdvertisementEdit()">å–æ¶ˆ</button>
                        </div>
                    </form>
                </div>
                
                <!-- å¹¿å‘Šåˆ—è¡¨ -->
                <div class="admin-list">
                    <h4>å¹¿å‘Šåˆ—è¡¨</h4>
                    <table style="width: 100%; border-collapse: collapse; margin-top: 10px;">
                        <thead>
                            <tr style="background: #f8fafc;">
                                <th style="padding: 10px; text-align: left; border-bottom: 1px solid #e2e8f0;">ID</th>
                                <th style="padding: 10px; text-align: left; border-bottom: 1px solid #e2e8f0;">å¹¿å‘Šæ ‡é¢˜</th>
                                <th style="padding: 10px; text-align: left; border-bottom: 1px solid #e2e8f0;">å¹¿å‘Šå†…å®¹</th>
                                <th style="padding: 10px; text-align: left; border-bottom: 1px solid #e2e8f0;">å›¾ç‰‡</th>
                                <th style="padding: 10px; text-align: left; border-bottom: 1px solid #e2e8f0;">çŠ¶æ€</th>
                                <th style="padding: 10px; text-align: left; border-bottom: 1px solid #e2e8f0;">æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody id="advertisementsList">
                            <!-- åŠ¨æ€ç”Ÿæˆå¹¿å‘Šåˆ—è¡¨ -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- æ•°æ®ç®¡ç† -->
            <div id="dataSection" class="admin-section" style="display: none;">
                <h3>æ•°æ®ç®¡ç†</h3>
                <div class="admin-form" style="margin-bottom: 20px; padding: 20px; background: #f8fafc; border-radius: 8px;">
                    <h4>æ•°æ®å¯¼å‡º</h4>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <p style="margin: 0;">å°†å½“å‰æ‰€æœ‰æ•°æ®å¯¼å‡ºä¸ºJSONæ–‡ä»¶ï¼š</p>
                        <button type="button" class="form-submit" style="padding: 10px 20px; background: #6952EB;" onclick="exportData()">å¯¼å‡ºæ•°æ®</button>
                    </div>
                </div>
            </div>
            
            <!-- ä¸ªäººè®¾ç½® -->
            <div id="profileSection" class="admin-section" style="display: none;">
                <h3>ä¸ªäººè®¾ç½®</h3>
                <div class="admin-form" style="margin-bottom: 20px; padding: 20px; background: #f8fafc; border-radius: 8px;">
                    <h4>ä¿®æ”¹å¯†ç </h4>
                    <form id="changePasswordForm">
                        <div style="max-width: 500px; margin: 0 auto;">
                            <div style="margin-bottom: 15px;">
                                <label style="display: block; margin-bottom: 5px;">å½“å‰å¯†ç ï¼š</label>
                                <input type="password" id="currentPassword" style="width: 100%; padding: 10px; border: 1px solid #e2e8f0; border-radius: 4px;" placeholder="å¿˜è®°å¯†ç å¯ä½¿ç”¨ä¸‹æ–¹å£ä»¤">
                            </div>
                            <div style="margin-bottom: 15px;">
                                <label style="display: block; margin-bottom: 5px;">æˆ–ä½¿ç”¨å£ä»¤å¯†ç ï¼š</label>
                                <input type="password" id="passphrase" style="width: 100%; padding: 10px; border: 1px solid #e2e8f0; border-radius: 4px;" placeholder="è¾“å…¥å£ä»¤å¯†ç ">
                            </div>
                            <div style="margin-bottom: 15px;">
                                <label style="display: block; margin-bottom: 5px;">æ–°å¯†ç ï¼š</label>
                                <input type="password" id="newPassword" style="width: 100%; padding: 10px; border: 1px solid #e2e8f0; border-radius: 4px;">
                            </div>
                            <div style="margin-bottom: 20px;">
                                <label style="display: block; margin-bottom: 5px;">ç¡®è®¤æ–°å¯†ç ï¼š</label>
                                <input type="password" id="confirmPassword" style="width: 100%; padding: 10px; border: 1px solid #e2e8f0; border-radius: 4px;">
                            </div>
                            <div style="display: flex; gap: 10px;">
                                <button type="submit" class="form-submit" style="width: auto; padding: 10px 20px; background: #6952EB;">ä¿å­˜ä¿®æ”¹</button>
                                <button type="button" class="form-submit" style="width: auto; padding: 10px 20px; background: #6b7280;" onclick="cancelChangePassword()">å–æ¶ˆ</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    
    <!-- æ»šåŠ¨å¹¿å‘Šå®¹å™¨ -->
    <div class="advertisement-container" id="advertisementContainer">
        <!-- å¹¿å‘Šæ»šåŠ¨å†…å®¹ -->
        <div class="advertisement-scroll-content" id="advertisementScrollContent">
            <!-- åŠ¨æ€ç”Ÿæˆæ»šåŠ¨å¹¿å‘Šå†…å®¹ -->
        </div>
        <!-- å¹¿å‘Šæ»šåŠ¨æ§åˆ¶æŒ‰é’® -->
        <div class="ad-scroll-controls">
            <button class="ad-scroll-btn" id="adAutoScrollBtn">è‡ªåŠ¨æ»šåŠ¨</button>
            <button class="ad-scroll-btn" id="adStopScrollBtn">åœæ­¢æ»šåŠ¨</button>
        </div>
    </div>
    
    <!-- é¡µè„š -->
    <footer>
        <p>&copy; 2024 æ¸¸æˆäº¤æ˜“å¹³å° - ç‰ˆæƒæ‰€æœ‰-è”ç³»ç”µè¯:13894338888</p>
    </footer>

    <script>
        // æ•°æ®å­˜å‚¨é”®å
        const STORAGE_KEYS = {
            USERS: 'game_trade_users',
            PRODUCTS: 'game_trade_products',
            NOTIFICATIONS: 'game_trade_notifications',
            ADVERTISEMENTS: 'game_trade_advertisements',
            CURRENT_USER: 'game_trade_current_user',
            SERVERS: 'game_trade_servers',
            GAMES: 'game_trade_games'
        };

        // å½“å‰é€‰æ‹©çš„æ¸¸æˆ
        let currentGame = null;
        let currentUser = null;
        let games = [];
        let products = [];
        let servers = [];
        let notifications = [];
        let advertisements = [];
        
        // ç™»å½•å¤±è´¥è®¡æ•°å™¨ï¼Œå­˜å‚¨åœ¨localStorageä¸­
        const LOGIN_FAIL_COUNT_KEY = 'game_trade_login_fail_count';
        let loginFailCount = loadFromStorage(LOGIN_FAIL_COUNT_KEY, {});

        // åˆå§‹æ•°æ®
        const INITIAL_DATA = {
            users: {
                'admin': {
                    username: 'admin',
                    email: 'admin@system.com',
                    password: 'admin',
                    isAdmin: true,
                    registeredDate: '2024-01-01'
                }
            },
            games: [
                {id: 1, name: 'ì•„ì´ì˜¨2', image: 'img/ì•„ì´ì˜¨.jpg'},
                {id: 2, name: 'ë¦¬ë‹ˆì§€2', image: 'img/ë¦¬ë‹ˆì§€2.jpg'},
                {id: 3, name: 'ë¦¬ë‹ˆì§€M', image: 'img/ë¦¬ë‹ˆì§€m.jpg'}
            ],
            products: [
                {id: 1, name: 'æ»¡çº§ç¥è£… 3000æˆ˜åŠ›', server: 'å¤©å¯[å¤©æ—]', unit: 'ä»¶', price: 899, stock: 5, category: 'è£…å¤‡', seller: 'è£…å¤‡ä¸“å–', gameId: 1},
                {id: 2, name: 'æ¸¸æˆå¸ æ‰‹å·¥æ‰“é‡‘', server: 'è£è€€[é­”æ—]', unit: 'ä¸‡', price: 320, stock: 999, category: 'æ¸¸æˆå¸', seller: 'æ¸¸æˆå¸å•†', gameId: 1},
                {id: 3, name: 'æ»¡çº§è´¦å· 2800æˆ˜åŠ›', server: 'æ°¸æ’[å¤©æ—]', unit: 'ä¸ª', price: 1599, stock: 1, category: 'è´¦å·', seller: 'è´¦å·å•†', gameId: 1}
            ],
            servers: [
                {id: 1, name: 'å¤©å¯[å¤©æ—]', gameId: 1},
                {id: 2, name: 'è£è€€[é­”æ—]', gameId: 1},
                {id: 3, name: 'æ°¸æ’[å¤©æ—]', gameId: 1}
            ],
            notifications: [
                {id: 1, content: 'æ¬¢è¿æ¥åˆ°æ¸¸æˆäº¤æ˜“å¹³å°ï¼', enabled: true},
                {id: 2, content: 'ç°åœ¨æ³¨å†Œå³å¯è·å¾—5%çš„æŠ˜æ‰£ï¼', enabled: true}
            ],
            advertisements: [
                {id: 1, title: 'æ–°æœå¼€å¯', content: 'æ–°æœå¤©å¯[å¤©æ—]å·²å¼€å¯ï¼Œæ¬¢è¿åŠ å…¥ï¼', image: '', enabled: true},
                {id: 2, title: 'é™æ—¶ä¼˜æƒ ', content: 'æ¸¸æˆå¸è´­ä¹°äº«å—9æŠ˜ä¼˜æƒ ï¼Œé™æ—¶3å¤©ï¼', image: '', enabled: true}
            ]
        };

        // ä»localStorageåŠ è½½æ•°æ®
        function loadFromStorage(key, defaultValue) {
            try {
                const item = localStorage.getItem(key);
                return item ? JSON.parse(item) : defaultValue;
            } catch (error) {
                console.error('åŠ è½½æ•°æ®å¤±è´¥:', error);
                return defaultValue;
            }
        }

        // ä¿å­˜æ•°æ®åˆ°localStorage
        function saveToStorage(key, data) {
            try {
                localStorage.setItem(key, JSON.stringify(data));
                return true;
            } catch (error) {
                console.error('ä¿å­˜æ•°æ®å¤±è´¥:', error);
                return false;
            }
        }
        
        // å¯¼å‡ºæ•°æ®ä¸ºJSONæ–‡ä»¶
        function exportData() {
            try {
                // è·å–æ‰€æœ‰æ•°æ®
                const allData = {
                    users: loadFromStorage(STORAGE_KEYS.USERS, []),
                    games: loadFromStorage(STORAGE_KEYS.GAMES, []),
                    products: loadFromStorage(STORAGE_KEYS.PRODUCTS, []),
                    servers: loadFromStorage(STORAGE_KEYS.SERVERS, []),
                    exportTime: new Date().toISOString()
                };
                
                // è½¬æ¢ä¸ºJSONå­—ç¬¦ä¸²
                const jsonStr = JSON.stringify(allData, null, 2);
                
                // åˆ›å»ºBlobå¯¹è±¡
                const blob = new Blob([jsonStr], { type: 'application/json' });
                
                // åˆ›å»ºä¸‹è½½é“¾æ¥
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `game_trade_data_${new Date().getTime()}.json`;
                
                // è§¦å‘ä¸‹è½½
                document.body.appendChild(a);
                a.click();
                
                // æ¸…ç†
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                alert('æ•°æ®å¯¼å‡ºæˆåŠŸï¼');
            } catch (error) {
                console.error('æ•°æ®å¯¼å‡ºå¤±è´¥:', error);
                alert('æ•°æ®å¯¼å‡ºå¤±è´¥ï¼è¯·æŸ¥çœ‹æ§åˆ¶å°è·å–è¯¦ç»†ä¿¡æ¯ã€‚');
            }
        }


        
        // åˆå§‹åŒ–æ•°æ®
        async function initializeData() {
            // ç›´æ¥ä½¿ç”¨localStorageæˆ–åˆå§‹æ•°æ®ï¼Œä¸å†å°è¯•ä»æœåŠ¡å™¨åŠ è½½
            // åŠ è½½ç”¨æˆ·æ•°æ®
            const users = loadFromStorage(STORAGE_KEYS.USERS, INITIAL_DATA.users);
            saveToStorage(STORAGE_KEYS.USERS, users);
            
            // åŠ è½½æ¸¸æˆæ•°æ®
            games = loadFromStorage(STORAGE_KEYS.GAMES, INITIAL_DATA.games);
            saveToStorage(STORAGE_KEYS.GAMES, games);
            
            // åŠ è½½å•†å“æ•°æ®
            products = loadFromStorage(STORAGE_KEYS.PRODUCTS, INITIAL_DATA.products);
            saveToStorage(STORAGE_KEYS.PRODUCTS, products);
            
            // åŠ è½½æœåŠ¡å™¨æ•°æ®
            servers = loadFromStorage(STORAGE_KEYS.SERVERS, INITIAL_DATA.servers);
            saveToStorage(STORAGE_KEYS.SERVERS, servers);
            
            // åŠ è½½é€šçŸ¥æ•°æ®
            notifications = loadFromStorage(STORAGE_KEYS.NOTIFICATIONS, INITIAL_DATA.notifications);
            saveToStorage(STORAGE_KEYS.NOTIFICATIONS, notifications);
            
            // åŠ è½½å¹¿å‘Šæ•°æ®
            advertisements = loadFromStorage(STORAGE_KEYS.ADVERTISEMENTS, INITIAL_DATA.advertisements);
            saveToStorage(STORAGE_KEYS.ADVERTISEMENTS, advertisements);
            
            // åŠ è½½å½“å‰ç”¨æˆ·
            currentUser = loadFromStorage(STORAGE_KEYS.CURRENT_USER, null);
        }

        // ç”Ÿæˆæ¸¸æˆé€‰æ‹©ç•Œé¢
        function generateGameSelection() {
            const gameGrid = document.getElementById('gameGrid');
            if (!gameGrid) return;
            
            gameGrid.innerHTML = '';
            
            games.forEach(game => {
                const gameCard = document.createElement('div');
                gameCard.className = 'game-card';
                gameCard.addEventListener('click', () => selectGame(game));
                
                // åˆ›å»ºæ¸¸æˆå›¾ç‰‡å®¹å™¨
                const gameImageContainer = document.createElement('div');
                gameImageContainer.className = 'game-image';
                
                // åˆ›å»ºæ¸¸æˆå›¾ç‰‡
                const gameImage = document.createElement('img');
                gameImage.src = game.image;
                gameImage.alt = game.name;
                gameImage.style.width = '100%';
                gameImage.style.height = '100%';
                gameImage.style.objectFit = 'contain';
                
                // å°†å›¾ç‰‡æ·»åŠ åˆ°å®¹å™¨
                gameImageContainer.appendChild(gameImage);
                
                const gameName = document.createElement('div');
                gameName.className = 'game-name';
                gameName.textContent = game.name;
                
                gameCard.appendChild(gameImageContainer);
                gameCard.appendChild(gameName);
                gameGrid.appendChild(gameCard);
            });
        }

        // é€‰æ‹©æ¸¸æˆ
        function selectGame(game) {
            // æ£€æŸ¥æ˜¯å¦ç™»å½•
            if (!currentUser) {
                // æœªç™»å½•ï¼Œæ˜¾ç¤ºç™»å½•æ¨¡æ€æ¡†
                alert('è¯·å…ˆç™»å½•æ‰èƒ½è¿›å…¥äº¤æ˜“å¹³å°ï¼');
                document.getElementById('loginModal').style.display = 'block';
                
                return;
            }
            
            currentGame = game;
            document.getElementById('gameSelection').style.display = 'none';
            document.getElementById('mainContainer').style.display = 'block';
            generateProductList();
            generateRecommendedProducts();
        }

        // ç”Ÿæˆå•†å“åˆ—è¡¨
        function generateProductList() {
            const productGrid = document.getElementById('productGrid');
            if (!productGrid) return;
            
            productGrid.innerHTML = '';
            
            const filteredProducts = products.filter(product => product.gameId === currentGame.id);
            
            filteredProducts.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                
                productCard.innerHTML = `
                    <div class="product-name">${product.name}</div>
                    <div class="product-info">æœåŠ¡å™¨: ${product.server}</div>
                    <div class="product-info">ç±»å‹: ${product.category}</div>
                    <div class="product-info">å•ä½: ${product.unit}</div>
                    <div class="product-info">å–å®¶: ${product.seller}</div>
                    <div class="product-info">åº“å­˜: ${product.stock}</div>
                    <div class="product-price">Â¥${product.price}/${product.unit}</div>
                `;
                
                productGrid.appendChild(productCard);
            });
        }

        // ç”Ÿæˆç®¡ç†å‘˜æ§åˆ¶æŒ‰é’®
        function generateAdminControls() {
            const adminControls = document.getElementById('adminControls');
            if (!adminControls) return;
            
            if (currentUser && currentUser.isAdmin && currentGame) {
                adminControls.innerHTML = `
                    <button onclick="toggleAddProductForm()" class="form-submit" style="width: auto; padding: 8px 16px; background: #6952EB;">æ·»åŠ æ–°å•†å“</button>
                `;
            } else {
                adminControls.innerHTML = '';
            }
        }
        
        // åˆ‡æ¢æ·»åŠ å•†å“è¡¨å•æ˜¾ç¤º/éšè—
        function toggleAddProductForm() {
            const addProductForm = document.getElementById('addProductForm');
            if (addProductForm.style.display === 'none' || addProductForm.style.display === '') {
                addProductForm.style.display = 'block';
            } else {
                addProductForm.style.display = 'none';
            }
        }
        
        // æ·»åŠ æ–°å•†å“
        function addNewProduct() {
            // è·å–è¡¨å•æ•°æ®
            const productName = document.getElementById('newProductName').value.trim();
            const productServer = document.getElementById('newProductServer').value.trim();
            const productCategory = document.getElementById('newProductCategory').value.trim();
            const productUnit = document.getElementById('newProductUnit').value.trim();
            const productPrice = parseFloat(document.getElementById('newProductPrice').value) || 0;
            const productStock = parseInt(document.getElementById('newProductStock').value) || 0;
            const productSeller = document.getElementById('newProductSeller').value.trim();
            
            // éªŒè¯è¡¨å•
            if (!productName) {
                alert('è¯·è¾“å…¥å•†å“åç§°ï¼');
                return;
            }
            
            if (!productServer) {
                alert('è¯·è¾“å…¥æœåŠ¡å™¨åç§°ï¼');
                return;
            }
            
            if (!productCategory) {
                alert('è¯·è¾“å…¥åˆ†ç±»åç§°ï¼');
                return;
            }
            
            if (!productUnit) {
                alert('è¯·è¾“å…¥å•ä½ï¼');
                return;
            }
            
            if (!productSeller) {
                alert('è¯·è¾“å…¥å–å®¶åç§°ï¼');
                return;
            }
            
            // åˆ›å»ºæ–°å•†å“
            const newProduct = {
                id: products.length > 0 ? Math.max(...products.map(p => p.id)) + 1 : 1,
                name: productName,
                server: productServer,
                category: productCategory,
                unit: productUnit,
                price: productPrice,
                stock: productStock,
                seller: productSeller,
                gameId: currentGame.id
            };
            
            // æ·»åŠ åˆ°å•†å“åˆ—è¡¨
            products.push(newProduct);
            
            // ä¿å­˜åˆ°å­˜å‚¨
            saveToStorage(STORAGE_KEYS.PRODUCTS, products);
            
            // æ›´æ–°åˆ—è¡¨
            generateRecommendedProducts();
            generateProductList();
            
            // æ¸…ç©ºè¡¨å•
            document.getElementById('newProductName').value = '';
            document.getElementById('newProductServer').value = '';
            document.getElementById('newProductCategory').value = '';
            document.getElementById('newProductUnit').value = '';
            document.getElementById('newProductPrice').value = '';
            document.getElementById('newProductStock').value = '';
            document.getElementById('newProductSeller').value = '';
            
            // éšè—è¡¨å•
            toggleAddProductForm();
            
            alert('å•†å“æ·»åŠ æˆåŠŸï¼');
        }
        
        // ç”Ÿæˆæ¨èäº§å“
        function generateRecommendedProducts() {
            // æ›´æ–°æ¨èäº§å“æ ‡é¢˜ï¼Œæ˜¾ç¤ºå½“å‰æ¸¸æˆåç§°
            const sectionTitle = document.querySelector('.recommended-section .section-title');
            if (sectionTitle && currentGame) {
                sectionTitle.textContent = `${currentGame.name} - æ¨èäº§å“`;
            }
            
            // ç”Ÿæˆç®¡ç†å‘˜æ§åˆ¶æŒ‰é’®
            generateAdminControls();
            
            const tableBody = document.getElementById('recommendedTableBody');
            if (!tableBody) return;
            
            tableBody.innerHTML = '';
            
            const filteredProducts = products.filter(product => product.gameId === currentGame.id);
            
            filteredProducts.forEach(product => {
                const row = document.createElement('tr');
                row.dataset.productId = product.id;
                
                // æ£€æŸ¥æ˜¯å¦ä¸ºç®¡ç†å‘˜ï¼Œç®¡ç†å‘˜å¯ä»¥ç¼–è¾‘ï¼Œæ™®é€šç”¨æˆ·åªèƒ½æŸ¥çœ‹
                if (currentUser && currentUser.isAdmin) {
                    // ç®¡ç†å‘˜æ¨¡å¼ - å¯ç¼–è¾‘è¡¨æ ¼
                    row.innerHTML = `
                        <td>
                            <input type="text" class="edit-input" value="${product.name}" data-field="name" style="width: 150px; padding: 5px; border: 1px solid #e2e8f0; border-radius: 4px;">
                        </td>
                        <td>
                            <input type="text" class="edit-input" value="${product.server}" data-field="server" style="width: 120px; padding: 5px; border: 1px solid #e2e8f0; border-radius: 4px;">
                        </td>
                        <td style="display: flex; gap: 5px; align-items: center;">
                            <input type="number" class="edit-input" value="${product.price}" data-field="price" style="width: 80px; padding: 5px; border: 1px solid #e2e8f0; border-radius: 4px;" min="0" step="0.01">
                            <span>/</span>
                            <input type="text" class="edit-input" value="${product.unit}" data-field="unit" style="width: 50px; padding: 5px; border: 1px solid #e2e8f0; border-radius: 4px;">
                        </td>
                        <td>
                            <input type="number" class="edit-input" value="${product.stock}" data-field="stock" style="width: 60px; padding: 5px; border: 1px solid #e2e8f0; border-radius: 4px;" min="0">
                        </td>
                        <td>
                            <button class="form-submit" onclick="saveRecommendedProduct(${product.id})" style="width: auto; padding: 5px 10px; font-size: 12px; background: #10b981;">ä¿å­˜</button>
                            <button class="form-submit" onclick="deleteRecommendedProduct(${product.id})" style="width: auto; padding: 5px 10px; font-size: 12px; background: #ef4444; margin-left: 5px;">åˆ é™¤</button>
                        </td>
                    `;
                } else {
                    // æ™®é€šç”¨æˆ·æ¨¡å¼ - åªè¯»è¡¨æ ¼
                    row.innerHTML = `
                        <td>${product.name}</td>
                        <td>${product.server}</td>
                        <td>Â¥${product.price}/${product.unit}</td>
                        <td>${product.stock}</td>
                        <td><button class="form-submit" style="width: auto; padding: 5px 10px; font-size: 12px;">è´­ä¹°</button></td>
                    `;
                }
                
                tableBody.appendChild(row);
            });
        }
        
        // ä¿å­˜æ¨èå•†å“ä¿®æ”¹
        function saveRecommendedProduct(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) return;
            
            // è·å–ç¼–è¾‘åçš„å€¼
            const row = document.querySelector(`tr[data-product-id="${productId}"]`);
            const inputs = row.querySelectorAll('.edit-input');
            
            const updatedData = {};
            inputs.forEach(input => {
                const field = input.dataset.field;
                const value = input.value.trim();
                
                // æ ¹æ®å­—æ®µç±»å‹è¿›è¡Œç±»å‹è½¬æ¢
                if (field === 'price' || field === 'stock') {
                    updatedData[field] = parseFloat(value) || 0;
                } else {
                    updatedData[field] = value;
                }
            });
            
            // æ›´æ–°å•†å“æ•°æ®
            Object.assign(product, updatedData);
            
            // ä¿å­˜åˆ°å­˜å‚¨
            saveToStorage(STORAGE_KEYS.PRODUCTS, products);
            
            // æ›´æ–°å•†å“åˆ—è¡¨
            generateProductList();
            
            alert('å•†å“ä¿¡æ¯ä¿å­˜æˆåŠŸï¼');
        }
        
        // åˆ é™¤æ¨èå•†å“
        function deleteRecommendedProduct(productId) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå•†å“å—ï¼Ÿ')) {
                products = products.filter(p => p.id !== productId);
                saveToStorage(STORAGE_KEYS.PRODUCTS, products);
                
                // æ›´æ–°åˆ—è¡¨
                generateRecommendedProducts();
                generateProductList();
                
                alert('å•†å“åˆ é™¤æˆåŠŸï¼');
            }
        }

        // è¿”å›é¦–é¡µ
        function backToHome() {
            currentGame = null;
            document.getElementById('gameSelection').style.display = 'block';
            document.getElementById('mainContainer').style.display = 'none';
        }

        // é€€å›æŒ‰é’®
        function goBack() {
            // ç®€å•å®ç°ï¼šè¿”å›æ¸¸æˆé€‰æ‹©ç•Œé¢
            backToHome();
        }

        // æ›´æ–°å¯¼èˆªæ 
        function updateNavbar() {
            const navMenu = document.querySelector('.nav-menu');
            const loginBtn = document.getElementById('loginBtn');
            
            if (currentUser) {
                // å·²ç™»å½•çŠ¶æ€
                loginBtn.innerHTML = currentUser.username;
                
                // æ£€æŸ¥æ˜¯å¦å·²æœ‰ç®¡ç†å‘˜èœå•
                let adminMenuItem = document.getElementById('adminMenu');
                if (currentUser.isAdmin && !adminMenuItem) {
                    // æ·»åŠ ç®¡ç†å‘˜èœå•
                    adminMenuItem = document.createElement('li');
                    adminMenuItem.className = 'nav-item';
                    adminMenuItem.id = 'adminMenu';
                    adminMenuItem.innerHTML = '<a href="#" class="nav-link" onclick="showAdminPanel()">ç®¡ç†åå°</a>';
                    navMenu.appendChild(adminMenuItem);
                } else if (!currentUser.isAdmin && adminMenuItem) {
                    // ç§»é™¤ç®¡ç†å‘˜èœå•ï¼ˆå¦‚æœä¸æ˜¯ç®¡ç†å‘˜ï¼‰
                    adminMenuItem.remove();
                }
            } else {
                // æœªç™»å½•çŠ¶æ€
                loginBtn.innerHTML = 'ç™»å½•';
                // ç§»é™¤ç®¡ç†å‘˜èœå•
                const adminMenuItem = document.getElementById('adminMenu');
                if (adminMenuItem) {
                    adminMenuItem.remove();
                }
            }
        }
        
        // æ˜¾ç¤ºç®¡ç†å‘˜é¢æ¿
        function showAdminPanel() {
            const adminModal = document.getElementById('adminModal');
            adminModal.style.display = 'block';
            loadAdminData();
        }
        
        // åˆ‡æ¢ç®¡ç†åå°section
        function showAdminSection(sectionName) {
            // éšè—æ‰€æœ‰section
            document.querySelectorAll('.admin-section').forEach(section => {
                section.style.display = 'none';
            });
            
            // ç§»é™¤æ‰€æœ‰å¯¼èˆªæŒ‰é’®çš„activeç±»
            document.querySelectorAll('.admin-nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // æ˜¾ç¤ºé€‰ä¸­çš„section
            document.getElementById(sectionName + 'Section').style.display = 'block';
            
            // æ·»åŠ activeç±»åˆ°å½“å‰å¯¼èˆªæŒ‰é’®
            event.target.classList.add('active');
            
            // å¦‚æœæ˜¯å•†å“ç®¡ç†ï¼Œéœ€è¦é‡æ–°åŠ è½½æ¸¸æˆé€‰é¡¹
            if (sectionName === 'products') {
                loadGameOptions();
            }
        }
        
        // å¤„ç†å¯†ç ä¿®æ”¹è¡¨å•æäº¤
        function handleChangePassword(e) {
            e.preventDefault();
            
            const currentPassword = document.getElementById('currentPassword').value;
            const passphrase = document.getElementById('passphrase').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            // éªŒè¯æ–°å¯†ç 
            if (newPassword.length < 6) {
                alert('æ–°å¯†ç è‡³å°‘éœ€è¦6ä¸ªå­—ç¬¦ï¼');
                return;
            }
            
            if (newPassword !== confirmPassword) {
                alert('ä¸¤æ¬¡è¾“å…¥çš„æ–°å¯†ç ä¸ä¸€è‡´ï¼');
                return;
            }
            
            // ä»å­˜å‚¨ä¸­è·å–ç”¨æˆ·æ•°æ®
            const users = loadFromStorage(STORAGE_KEYS.USERS, INITIAL_DATA.users);
            const currentUserObj = users[currentUser.username];
            
            // éªŒè¯å½“å‰å¯†ç æˆ–å£ä»¤å¯†ç 
            const isCurrentPasswordValid = currentPassword === currentUserObj.password;
            const isPassphraseValid = passphrase === 'myadena';
            
            if (!isCurrentPasswordValid && !isPassphraseValid) {
                alert('å½“å‰å¯†ç æˆ–å£ä»¤å¯†ç é”™è¯¯ï¼');
                return;
            }
            
            // æ›´æ–°å¯†ç 
            currentUserObj.password = newPassword;
            saveToStorage(STORAGE_KEYS.USERS, users);
            
            // æ¸…ç©ºè¡¨å•
            cancelChangePassword();
            
            alert('å¯†ç ä¿®æ”¹æˆåŠŸï¼');
        }
        
        // å–æ¶ˆå¯†ç ä¿®æ”¹
        function cancelChangePassword() {
            document.getElementById('changePasswordForm').reset();
        }
        
        // åŠ è½½ç®¡ç†å‘˜æ•°æ®
        function loadAdminData() {
            loadGamesList();
            loadProductsList();
            loadUsersList();
            loadNotificationsList();
            loadAdvertisementsList();
            loadGameOptions();
        }
        
        // åŠ è½½æ¸¸æˆåˆ—è¡¨
        function loadGamesList() {
            const gamesList = document.getElementById('gamesList');
            gamesList.innerHTML = '';
            
            games.forEach(game => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${game.id}</td>
                    <td>${game.name}</td>
                    <td><img src="${game.image}" style="width: 50px; height: 50px; object-fit: contain;"></td>
                    <td>
                        <button onclick="editGame(${game.id})" style="padding: 5px 10px; margin-right: 5px; background: #6952EB; color: white; border: none; border-radius: 4px; cursor: pointer;">ç¼–è¾‘</button>
                        <button onclick="deleteGame(${game.id})" style="padding: 5px 10px; background: #ef4444; color: white; border: none; border-radius: 4px; cursor: pointer;">åˆ é™¤</button>
                    </td>
                `;
                gamesList.appendChild(row);
            });
        }
        
        // åŠ è½½å•†å“åˆ—è¡¨
        function loadProductsList() {
            const productsList = document.getElementById('productsList');
            productsList.innerHTML = '';
            
            products.forEach(product => {
                const game = games.find(g => g.id === product.gameId);
                const gameName = game ? game.name : 'æœªçŸ¥æ¸¸æˆ';
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${product.id}</td>
                    <td>${product.name}</td>
                    <td>${gameName}</td>
                    <td>${product.server}</td>
                    <td>${product.category}</td>
                    <td>${product.unit}</td>
                    <td>Â¥${product.price}</td>
                    <td>${product.stock}</td>
                    <td>${product.seller}</td>
                    <td>
                        <button onclick="editProduct(${product.id})" style="padding: 5px 10px; margin-right: 5px; background: #6952EB; color: white; border: none; border-radius: 4px; cursor: pointer;">ç¼–è¾‘</button>
                        <button onclick="deleteProduct(${product.id})" style="padding: 5px 10px; background: #ef4444; color: white; border: none; border-radius: 4px; cursor: pointer;">åˆ é™¤</button>
                    </td>
                `;
                productsList.appendChild(row);
            });
        }
        
        // åŠ è½½ç”¨æˆ·åˆ—è¡¨
        function loadUsersList() {
            const usersList = document.getElementById('usersList');
            const users = loadFromStorage(STORAGE_KEYS.USERS, INITIAL_DATA.users);
            
            usersList.innerHTML = '';
            
            Object.keys(users).forEach(username => {
                const user = users[username];
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${user.username}</td>
                    <td>${user.phone || 'N/A'}</td>
                    <td>${user.email || 'N/A'}</td>
                    <td>${user.registeredDate}</td>
                    <td>${user.isAdmin ? 'æ˜¯' : 'å¦'}</td>
                `;
                usersList.appendChild(row);
            });
        }
        
        // åŠ è½½æ¸¸æˆé€‰é¡¹åˆ°å•†å“è¡¨å•
        function loadGameOptions() {
            const gameSelect = document.getElementById('productGameId');
            gameSelect.innerHTML = '';
            
            games.forEach(game => {
                const option = document.createElement('option');
                option.value = game.id;
                option.textContent = game.name;
                gameSelect.appendChild(option);
            });
        }
        
        // ç¼–è¾‘æ¸¸æˆ
        function editGame(gameId) {
            const game = games.find(g => g.id === gameId);
            if (game) {
                document.getElementById('gameId').value = game.id;
                document.getElementById('gameName').value = game.name;
                document.getElementById('gameImageUrl').value = game.image || '';
                
                // æ˜¾ç¤ºå½“å‰å›¾ç‰‡é¢„è§ˆ
                const imagePreviewContainer = document.getElementById('gameImagePreviewContainer');
                const imagePreview = document.getElementById('gameImagePreview');
                if (game.image) {
                    imagePreview.src = game.image;
                    imagePreviewContainer.style.display = 'block';
                } else {
                    imagePreviewContainer.style.display = 'none';
                }
            }
        }
        
        // åˆ é™¤æ¸¸æˆ
        function deleteGame(gameId) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªæ¸¸æˆå—ï¼Ÿç›¸å…³å•†å“ä¹Ÿä¼šè¢«åˆ é™¤ã€‚')) {
                // åˆ é™¤æ¸¸æˆ
                games = games.filter(g => g.id !== gameId);
                saveToStorage(STORAGE_KEYS.GAMES, games);
                
                // åˆ é™¤ç›¸å…³å•†å“
                products = products.filter(p => p.gameId !== gameId);
                saveToStorage(STORAGE_KEYS.PRODUCTS, products);
                
                // æ›´æ–°åˆ—è¡¨
                loadGamesList();
                loadProductsList();
                
                alert('æ¸¸æˆåˆ é™¤æˆåŠŸï¼');
            }
        }
        
        // ç¼–è¾‘å•†å“
        function editProduct(productId) {
            const product = products.find(p => p.id === productId);
            if (product) {
                document.getElementById('productId').value = product.id;
                document.getElementById('productGameId').value = product.gameId;
                document.getElementById('productName').value = product.name;
                document.getElementById('productServer').value = product.server;
                document.getElementById('productCategory').value = product.category;
                document.getElementById('productUnit').value = product.unit || '';
                document.getElementById('productPrice').value = product.price;
                document.getElementById('productStock').value = product.stock;
                document.getElementById('productSeller').value = product.seller;
            }
        }
        
        // åˆ é™¤å•†å“
        function deleteProduct(productId) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå•†å“å—ï¼Ÿ')) {
                products = products.filter(p => p.id !== productId);
                saveToStorage(STORAGE_KEYS.PRODUCTS, products);
                loadProductsList();
                alert('å•†å“åˆ é™¤æˆåŠŸï¼');
            }
        }
        
        // å–æ¶ˆæ¸¸æˆç¼–è¾‘
        function cancelGameEdit() {
            document.getElementById('gameForm').reset();
            document.getElementById('gameId').value = '';
            document.getElementById('gameImageUrl').value = '';
            document.getElementById('gameImagePreviewContainer').style.display = 'none';
        }
        
        // å–æ¶ˆå•†å“ç¼–è¾‘
        function cancelProductEdit() {
            document.getElementById('productForm').reset();
            document.getElementById('productId').value = '';
        }
        
        // åŠ è½½é€šçŸ¥åˆ—è¡¨
        function loadNotificationsList() {
            const notificationsList = document.getElementById('notificationsList');
            if (!notificationsList) return;
            
            notificationsList.innerHTML = '';
            
            notifications.forEach(notification => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${notification.id}</td>
                    <td>${notification.content}</td>
                    <td>${notification.enabled ? 'å¯ç”¨' : 'ç¦ç”¨'}</td>
                    <td>
                        <button onclick="editNotification(${notification.id})" class="form-submit" style="width: auto; padding: 5px 10px; font-size: 12px; background: #3b82f6;">ç¼–è¾‘</button>
                        <button onclick="deleteNotification(${notification.id})" class="form-submit" style="width: auto; padding: 5px 10px; font-size: 12px; background: #ef4444; margin-left: 5px;">åˆ é™¤</button>
                    </td>
                `;
                notificationsList.appendChild(row);
            });
        }
        
        // åŠ è½½å¹¿å‘Šåˆ—è¡¨
        function loadAdvertisementsList() {
            const advertisementsList = document.getElementById('advertisementsList');
            if (!advertisementsList) return;
            
            advertisementsList.innerHTML = '';
            
            advertisements.forEach(ad => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${ad.id}</td>
                    <td>${ad.title}</td>
                    <td>${ad.content}</td>
                    <td>${ad.image ? `<img src="${ad.image}" style="width: 50px; height: 50px; object-fit: contain;">` : 'æ— '}</td>
                    <td>${ad.enabled ? 'å¯ç”¨' : 'ç¦ç”¨'}</td>
                    <td>
                        <button onclick="editAdvertisement(${ad.id})" class="form-submit" style="width: auto; padding: 5px 10px; font-size: 12px; background: #3b82f6;">ç¼–è¾‘</button>
                        <button onclick="deleteAdvertisement(${ad.id})" class="form-submit" style="width: auto; padding: 5px 10px; font-size: 12px; background: #ef4444; margin-left: 5px;">åˆ é™¤</button>
                    </td>
                `;
                advertisementsList.appendChild(row);
            });
        }
        
        // ç¼–è¾‘é€šçŸ¥
        function editNotification(id) {
            // ç¡®ä¿ id æ˜¯æœ‰æ•ˆæ•°å­—
            if (typeof id !== 'number' || isNaN(id)) {
                console.error('æ— æ•ˆçš„é€šçŸ¥ID:', id);
                return;
            }
            
            const notification = notifications.find(n => n.id === id);
            if (!notification) {
                console.error('æ‰¾ä¸åˆ°å¯¹åº”çš„é€šçŸ¥:', id);
                return;
            }
            
            // ç¡®ä¿ notification.enabled æ˜¯å¸ƒå°”å€¼
            const enabledValue = typeof notification.enabled === 'boolean' ? notification.enabled : false;
            
            document.getElementById('notificationId').value = notification.id;
            document.getElementById('notificationContent').value = notification.content || '';
            document.getElementById('notificationEnabled').value = enabledValue.toString();
        }
        
        // ç¼–è¾‘å¹¿å‘Š
        function editAdvertisement(id) {
            // ç¡®ä¿ id æ˜¯æœ‰æ•ˆæ•°å­—
            if (typeof id !== 'number' || isNaN(id)) {
                console.error('æ— æ•ˆçš„å¹¿å‘ŠID:', id);
                return;
            }
            
            const ad = advertisements.find(a => a.id === id);
            if (!ad) {
                console.error('æ‰¾ä¸åˆ°å¯¹åº”çš„å¹¿å‘Š:', id);
                return;
            }
            
            // ç¡®ä¿ ad.enabled æ˜¯å¸ƒå°”å€¼
            const enabledValue = typeof ad.enabled === 'boolean' ? ad.enabled : false;
            
            document.getElementById('advertisementId').value = ad.id;
            document.getElementById('advertisementTitle').value = ad.title || '';
            document.getElementById('advertisementContent').value = ad.content || '';
            document.getElementById('advertisementImage').value = ad.image || '';
            document.getElementById('advertisementEnabled').value = enabledValue.toString();
            
            // æ˜¾ç¤ºå·²ä¸Šä¼ çš„å›¾ç‰‡é¢„è§ˆ
            const imagePreviewContainer = document.getElementById('imagePreviewContainer');
            const imagePreview = document.getElementById('imagePreview');
            if (ad.image) {
                imagePreview.src = ad.image;
                imagePreviewContainer.style.display = 'block';
                // æ·»åŠ åˆ é™¤å›¾ç‰‡æŒ‰é’®
                if (!document.getElementById('removeImageBtn')) {
                    const removeBtn = document.createElement('button');
                    removeBtn.id = 'removeImageBtn';
                    removeBtn.textContent = 'åˆ é™¤å›¾ç‰‡';
                    removeBtn.style.cssText = 'margin-top: 10px; padding: 5px 10px; background: #ef4444; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;';
                    removeBtn.onclick = function() {
                        // æ¸…ç©ºå›¾ç‰‡
                        imagePreview.src = '';
                        imagePreviewContainer.style.display = 'none';
                        document.getElementById('advertisementImage').value = '';
                        document.getElementById('advertisementImageFile').value = '';
                        // ç§»é™¤åˆ é™¤æŒ‰é’®
                        if (this.parentNode) {
                            this.parentNode.removeChild(this);
                        }
                    };
                    imagePreviewContainer.appendChild(removeBtn);
                }
            } else {
                imagePreviewContainer.style.display = 'none';
                // ç§»é™¤åˆ é™¤æŒ‰é’®
                const removeBtn = document.getElementById('removeImageBtn');
                if (removeBtn && removeBtn.parentNode) {
                    removeBtn.parentNode.removeChild(removeBtn);
                }
            }
        }
        
        // å›¾ç‰‡ä¸Šä¼ å¤„ç†
        const advertisementImageFile = document.getElementById('advertisementImageFile');
        if (advertisementImageFile) {
            advertisementImageFile.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                // æ£€æŸ¥æ–‡ä»¶ç±»å‹
                if (!file.type.startsWith('image/')) {
                    alert('è¯·é€‰æ‹©å›¾ç‰‡æ–‡ä»¶ï¼');
                    return;
                }
                
                // é™åˆ¶å›¾ç‰‡å¤§å°ï¼ˆæœ€å¤§2MBï¼‰
                const MAX_SIZE = 2 * 1024 * 1024; // 2MB
                if (file.size > MAX_SIZE) {
                    alert('å›¾ç‰‡å¤§å°ä¸èƒ½è¶…è¿‡2MBï¼');
                    return;
                }
                
                // è¯»å–æ–‡ä»¶å¹¶æ˜¾ç¤ºé¢„è§ˆ
                const reader = new FileReader();
                reader.onload = function(e) {
                    const imageUrl = e.target.result;
                    
                    // å‹ç¼©å›¾ç‰‡
                    compressImage(imageUrl, function(compressedImageUrl) {
                        // æ˜¾ç¤ºå›¾ç‰‡é¢„è§ˆ
                        const imagePreviewContainer = document.getElementById('imagePreviewContainer');
                        const imagePreview = document.getElementById('imagePreview');
                        imagePreview.src = compressedImageUrl;
                        imagePreviewContainer.style.display = 'block';
                        
                        // å°†å‹ç¼©åçš„å›¾ç‰‡URLä¿å­˜åˆ°éšè—å­—æ®µ
                        document.getElementById('advertisementImage').value = compressedImageUrl;
                    });
                };
                
                reader.readAsDataURL(file);
            });
        }
        
        // å›¾ç‰‡å‹ç¼©å‡½æ•°
        function compressImage(dataUrl, callback) {
            const img = new Image();
            img.src = dataUrl;
            img.onload = function() {
                // åˆ›å»ºcanvaså…ƒç´ 
                const canvas = document.createElement('canvas');
                let width = img.width;
                let height = img.height;
                
                // é™åˆ¶å›¾ç‰‡æœ€å¤§å°ºå¯¸
                const MAX_DIMENSION = 800;
                if (width > MAX_DIMENSION || height > MAX_DIMENSION) {
                    const ratio = Math.min(MAX_DIMENSION / width, MAX_DIMENSION / height);
                    width *= ratio;
                    height *= ratio;
                }
                
                canvas.width = width;
                canvas.height = height;
                
                // ç»˜åˆ¶å›¾ç‰‡åˆ°canvas
                const ctx = canvas.getContext('2d');
                ctx.drawImage(img, 0, 0, width, height);
                
                // å‹ç¼©å›¾ç‰‡è´¨é‡ï¼ˆ0.7è¡¨ç¤º70%è´¨é‡ï¼‰
                const compressedDataUrl = canvas.toDataURL('image/jpeg', 0.7);
                callback(compressedDataUrl);
            };
        }
        
        // æ¸¸æˆå›¾æ ‡ä¸Šä¼ å¤„ç†
        const gameImageFile = document.getElementById('gameImageFile');
        if (gameImageFile) {
            gameImageFile.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                // æ£€æŸ¥æ–‡ä»¶ç±»å‹
                if (!file.type.startsWith('image/')) {
                    alert('è¯·é€‰æ‹©å›¾ç‰‡æ–‡ä»¶ï¼');
                    return;
                }
                
                // é™åˆ¶å›¾ç‰‡å¤§å°ï¼ˆæœ€å¤§2MBï¼‰
                const MAX_SIZE = 2 * 1024 * 1024; // 2MB
                if (file.size > MAX_SIZE) {
                    alert('å›¾ç‰‡å¤§å°ä¸èƒ½è¶…è¿‡2MBï¼');
                    return;
                }
                
                // è¯»å–æ–‡ä»¶å¹¶æ˜¾ç¤ºé¢„è§ˆ
                const reader = new FileReader();
                reader.onload = function(e) {
                    const imageUrl = e.target.result;
                    
                    // å‹ç¼©å›¾ç‰‡
                    compressImage(imageUrl, function(compressedImageUrl) {
                        // æ˜¾ç¤ºå›¾ç‰‡é¢„è§ˆ
                        const imagePreviewContainer = document.getElementById('gameImagePreviewContainer');
                        const imagePreview = document.getElementById('gameImagePreview');
                        imagePreview.src = compressedImageUrl;
                        imagePreviewContainer.style.display = 'block';
                        
                        // å°†å‹ç¼©åçš„å›¾ç‰‡URLä¿å­˜åˆ°éšè—å­—æ®µ
                        document.getElementById('gameImageUrl').value = compressedImageUrl;
                    });
                };
                
                reader.readAsDataURL(file);
            });
        }
        
        // ä¿å­˜é€šçŸ¥
        document.getElementById('notificationForm')?.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const id = parseInt(document.getElementById('notificationId').value) || 0;
            const content = document.getElementById('notificationContent').value.trim();
            const enabled = document.getElementById('notificationEnabled').value === 'true';
            
            if (!content) {
                alert('è¯·è¾“å…¥é€šçŸ¥å†…å®¹ï¼');
                return;
            }
            
            if (id) {
                // ç¼–è¾‘ç°æœ‰é€šçŸ¥
                const index = notifications.findIndex(n => n.id === id);
                if (index !== -1) {
                    notifications[index] = {
                        id: id,
                        content: content,
                        enabled: enabled
                    };
                }
            } else {
                // æ·»åŠ æ–°é€šçŸ¥
                const newId = notifications.length > 0 ? Math.max(...notifications.map(n => n.id)) + 1 : 1;
                notifications.push({
                    id: newId,
                    content: content,
                    enabled: enabled
                });
            }
            
            saveToStorage(STORAGE_KEYS.NOTIFICATIONS, notifications);
            loadNotificationsList();
            initializeMarquee();
            
            // æ¸…ç©ºè¡¨å•
            document.getElementById('notificationForm').reset();
            document.getElementById('notificationId').value = '';
            
            alert('é€šçŸ¥ä¿å­˜æˆåŠŸï¼');
        });
        
        // ä¿å­˜å¹¿å‘Š
        document.getElementById('advertisementForm')?.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const id = parseInt(document.getElementById('advertisementId').value) || 0;
            const title = document.getElementById('advertisementTitle').value.trim();
            const content = document.getElementById('advertisementContent').value.trim();
            const image = document.getElementById('advertisementImage').value.trim();
            const enabled = document.getElementById('advertisementEnabled').value === 'true';
            
            if (!title || !content) {
                alert('è¯·è¾“å…¥å¹¿å‘Šæ ‡é¢˜å’Œå†…å®¹ï¼');
                return;
            }
            
            if (id) {
                // ç¼–è¾‘ç°æœ‰å¹¿å‘Š
                const index = advertisements.findIndex(a => a.id === id);
                if (index !== -1) {
                    advertisements[index] = {
                        id: id,
                        title: title,
                        content: content,
                        image: image,
                        enabled: enabled
                    };
                }
            } else {
                // æ·»åŠ æ–°å¹¿å‘Š
                const newId = advertisements.length > 0 ? Math.max(...advertisements.map(a => a.id)) + 1 : 1;
                advertisements.push({
                    id: newId,
                    title: title,
                    content: content,
                    image: image,
                    enabled: enabled
                });
            }
            
            saveToStorage(STORAGE_KEYS.ADVERTISEMENTS, advertisements);
            loadAdvertisementsList();
            initializeAdvertisements();
            
            // æ¸…ç©ºè¡¨å•
            document.getElementById('advertisementForm').reset();
            document.getElementById('advertisementId').value = '';
            
            alert('å¹¿å‘Šä¿å­˜æˆåŠŸï¼');
        });
        
        // åˆ é™¤é€šçŸ¥
        function deleteNotification(id) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªé€šçŸ¥å—ï¼Ÿ')) {
                notifications = notifications.filter(n => n.id !== id);
                saveToStorage(STORAGE_KEYS.NOTIFICATIONS, notifications);
                loadNotificationsList();
                initializeMarquee();
                alert('é€šçŸ¥åˆ é™¤æˆåŠŸï¼');
            }
        }
        
        // åˆ é™¤å¹¿å‘Š
        function deleteAdvertisement(id) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå¹¿å‘Šå—ï¼Ÿ')) {
                advertisements = advertisements.filter(a => a.id !== id);
                saveToStorage(STORAGE_KEYS.ADVERTISEMENTS, advertisements);
                loadAdvertisementsList();
                initializeAdvertisements();
                alert('å¹¿å‘Šåˆ é™¤æˆåŠŸï¼');
            }
        }
        
        // å–æ¶ˆç¼–è¾‘é€šçŸ¥
        function cancelNotificationEdit() {
            document.getElementById('notificationForm').reset();
            document.getElementById('notificationId').value = '';
        }
        
        // å–æ¶ˆç¼–è¾‘å¹¿å‘Š
        function cancelAdvertisementEdit() {
            document.getElementById('advertisementForm').reset();
            document.getElementById('advertisementId').value = '';
        }
        
        // åˆå§‹åŒ–æ»šåŠ¨é€šçŸ¥æ˜¾ç¤º
        function initializeMarquee() {
            const marqueeContent = document.getElementById('marqueeContent');
            if (!marqueeContent) return;
            
            // è·å–å¯ç”¨çš„é€šçŸ¥
            const enabledNotifications = notifications.filter(n => n.enabled);
            if (enabledNotifications.length === 0) {
                marqueeContent.textContent = '';
                return;
            }
            
            // åˆå¹¶æ‰€æœ‰é€šçŸ¥å†…å®¹
            const content = enabledNotifications.map(n => n.content).join('   |   ');
            marqueeContent.textContent = content;
        }
        
        // åˆå§‹åŒ–å¹¿å‘Šæ˜¾ç¤º
        function initializeAdvertisements() {
            const advertisementContainer = document.getElementById('advertisementContainer');
            const scrollContent = document.getElementById('advertisementScrollContent');
            if (!advertisementContainer || !scrollContent) return;
            
            // è·å–å¯ç”¨çš„å¹¿å‘Š
            const enabledAdvertisements = advertisements.filter(a => a.enabled);
            if (enabledAdvertisements.length === 0) {
                advertisementContainer.innerHTML = '<p style="text-align: center; color: #666;">æš‚æ— å¹¿å‘Š</p>';
                return;
            }
            
            // ç”Ÿæˆå¹¿å‘Šå†…å®¹
            scrollContent.innerHTML = enabledAdvertisements.map(ad => `
                <div class="advertisement-item">
                    ${ad.image ? `<img src="${ad.image}" alt="${ad.title}" class="advertisement-image">` : ''}
                    <div class="advertisement-info">
                        <div class="advertisement-title">${ad.title}</div>
                        <div class="advertisement-text">${ad.content}</div>
                    </div>
                </div>
            `).join('');
            
            // åˆå§‹åŒ–è‡ªåŠ¨æ»šåŠ¨
            initializeAdAutoScroll();
        }
        
        // å¹¿å‘Šè‡ªåŠ¨æ»šåŠ¨åŠŸèƒ½
        let adScrollInterval = null;
        let isAutoScrolling = false;
        let adScrollPosition = 0;
        
        // åˆå§‹åŒ–å¹¿å‘Šè‡ªåŠ¨æ»šåŠ¨
        function initializeAdAutoScroll() {
            const scrollContent = document.getElementById('advertisementScrollContent');
            const container = document.getElementById('advertisementContainer');
            if (!scrollContent || !container) return;
            
            // æ·»åŠ æ»šåŠ¨æ§åˆ¶æŒ‰é’®äº‹ä»¶ï¼ˆä½¿ç”¨onceé¿å…é‡å¤æ·»åŠ ï¼‰
            const autoScrollBtn = document.getElementById('adAutoScrollBtn');
            const stopScrollBtn = document.getElementById('adStopScrollBtn');
            
            if (autoScrollBtn) {
                // ç§»é™¤å¯èƒ½å­˜åœ¨çš„æ—§äº‹ä»¶ç›‘å¬å™¨
                autoScrollBtn.removeEventListener('click', startAdAutoScroll);
                autoScrollBtn.addEventListener('click', startAdAutoScroll);
            }
            
            if (stopScrollBtn) {
                // ç§»é™¤å¯èƒ½å­˜åœ¨çš„æ—§äº‹ä»¶ç›‘å¬å™¨
                stopScrollBtn.removeEventListener('click', stopAdAutoScroll);
                stopScrollBtn.addEventListener('click', stopAdAutoScroll);
            }
            
            // åˆå§‹é»˜è®¤è‡ªåŠ¨æ»šåŠ¨
            startAdAutoScroll();
        }
        
        // å¼€å§‹å¹¿å‘Šè‡ªåŠ¨æ»šåŠ¨
        function startAdAutoScroll() {
            const scrollContent = document.getElementById('advertisementScrollContent');
            const container = document.getElementById('advertisementContainer');
            if (!scrollContent || !container) return;
            
            // åœæ­¢å½“å‰æ»šåŠ¨
            stopAdAutoScroll();
            
            isAutoScrolling = true;
            
            // è®¾ç½®æ»šåŠ¨é€Ÿåº¦
            const scrollSpeed = 1; // æ¯æ¬¡æ»šåŠ¨çš„åƒç´ æ•°
            const scrollInterval = 20; // æ»šåŠ¨é—´éš”ï¼ˆæ¯«ç§’ï¼‰
            
            adScrollInterval = setInterval(() => {
                if (!isAutoScrolling) return;
                
                // æ»šåŠ¨å†…å®¹
                scrollContent.scrollLeft += scrollSpeed;
                
                // æ£€æŸ¥æ˜¯å¦æ»šåŠ¨åˆ°åº•éƒ¨
                if (scrollContent.scrollLeft >= scrollContent.scrollWidth - container.offsetWidth) {
                    // é‡ç½®æ»šåŠ¨ä½ç½®
                    scrollContent.scrollLeft = 0;
                }
            }, scrollInterval);
        }
        
        // åœæ­¢å¹¿å‘Šè‡ªåŠ¨æ»šåŠ¨
        function stopAdAutoScroll() {
            isAutoScrolling = false;
            if (adScrollInterval) {
                clearInterval(adScrollInterval);
                adScrollInterval = null;
            }
        }
        
        // å¤„ç†æ¸¸æˆè¡¨å•æäº¤
        function handleGameForm(e) {
            e.preventDefault();
            
            const gameId = parseInt(document.getElementById('gameId').value);
            const gameName = document.getElementById('gameName').value.trim();
            const gameImageInput = document.getElementById('gameImageFile');
            const gameImageUrl = document.getElementById('gameImageUrl').value;
            
            if (!gameName) {
                alert('è¯·è¾“å…¥æ¸¸æˆåç§°ï¼');
                return;
            }
            
            // å¤„ç†å›¾ç‰‡ä¸Šä¼ 
            let imageUrl = gameImageUrl;
            if (gameImageInput.files.length > 0) {
                const file = gameImageInput.files[0];
                const reader = new FileReader();
                
                reader.onload = function(event) {
                    imageUrl = event.target.result;
                    saveGame(gameId, gameName, imageUrl);
                };
                
                reader.readAsDataURL(file);
            } else {
                // å¦‚æœæ²¡æœ‰ä¸Šä¼ æ–°å›¾ç‰‡ï¼Œä½¿ç”¨ç°æœ‰å›¾ç‰‡æˆ–é»˜è®¤å›¾ç‰‡
                if (gameId && !imageUrl) {
                    const existingGame = games.find(g => g.id === gameId);
                    imageUrl = existingGame ? existingGame.image : 'img/default-game.jpg';
                } else if (!gameId) {
                    imageUrl = 'img/default-game.jpg';
                }
                saveGame(gameId, gameName, imageUrl);
            }
        }
        
        // ä¿å­˜æ¸¸æˆ
        function saveGame(gameId, gameName, imageUrl) {
            if (gameId) {
                // ç¼–è¾‘ç°æœ‰æ¸¸æˆ
                const index = games.findIndex(g => g.id === gameId);
                if (index !== -1) {
                    games[index] = { ...games[index], name: gameName, image: imageUrl };
                    alert('æ¸¸æˆæ›´æ–°æˆåŠŸï¼');
                }
            } else {
                // æ·»åŠ æ–°æ¸¸æˆ
                const newGame = {
                    id: games.length > 0 ? Math.max(...games.map(g => g.id)) + 1 : 1,
                    name: gameName,
                    image: imageUrl
                };
                games.push(newGame);
                alert('æ¸¸æˆæ·»åŠ æˆåŠŸï¼');
            }
            
            // ä¿å­˜åˆ°å­˜å‚¨
            saveToStorage(STORAGE_KEYS.GAMES, games);
            
            // æ›´æ–°åˆ—è¡¨å’Œè¡¨å•
            loadGamesList();
            loadGameOptions();
            cancelGameEdit();
            
            // æ›´æ–°å‰ç«¯æ¸¸æˆé€‰æ‹©ç•Œé¢
            generateGameSelection();
        }
        
        // å¤„ç†å•†å“è¡¨å•æäº¤
        function handleProductForm(e) {
            e.preventDefault();
            
            const productId = parseInt(document.getElementById('productId').value);
            const productGameId = parseInt(document.getElementById('productGameId').value);
            const productName = document.getElementById('productName').value.trim();
            const productServer = document.getElementById('productServer').value.trim();
            const productCategory = document.getElementById('productCategory').value.trim();
            const productUnit = document.getElementById('productUnit').value.trim();
            const productPrice = parseFloat(document.getElementById('productPrice').value);
            const productStock = parseInt(document.getElementById('productStock').value);
            const productSeller = document.getElementById('productSeller').value.trim();
            
            // éªŒè¯è¡¨å•
            if (!productName) {
                alert('è¯·è¾“å…¥å•†å“åç§°ï¼');
                return;
            }
            
            if (!productServer) {
                alert('è¯·è¾“å…¥æœåŠ¡å™¨åç§°ï¼');
                return;
            }
            
            if (!productCategory) {
                alert('è¯·è¾“å…¥å•†å“åˆ†ç±»ï¼');
                return;
            }
            
            if (!productUnit) {
                alert('è¯·è¾“å…¥å•ä½ï¼');
                return;
            }
            
            if (isNaN(productPrice) || productPrice < 0) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„ä»·æ ¼ï¼');
                return;
            }
            
            if (isNaN(productStock) || productStock < 0) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„åº“å­˜ï¼');
                return;
            }
            
            if (!productSeller) {
                alert('è¯·è¾“å…¥å–å®¶åç§°ï¼');
                return;
            }
            
            const productData = {
                gameId: productGameId,
                name: productName,
                server: productServer,
                category: productCategory,
                unit: productUnit,
                price: productPrice,
                stock: productStock,
                seller: productSeller
            };
            
            if (productId) {
                // ç¼–è¾‘ç°æœ‰å•†å“
                const index = products.findIndex(p => p.id === productId);
                if (index !== -1) {
                    products[index] = { ...products[index], ...productData };
                    alert('å•†å“æ›´æ–°æˆåŠŸï¼');
                }
            } else {
                // æ·»åŠ æ–°å•†å“
                const newProduct = {
                    id: products.length > 0 ? Math.max(...products.map(p => p.id)) + 1 : 1,
                    ...productData
                };
                products.push(newProduct);
                alert('å•†å“æ·»åŠ æˆåŠŸï¼');
            }
            
            // ä¿å­˜åˆ°å­˜å‚¨
            saveToStorage(STORAGE_KEYS.PRODUCTS, products);
            
            // æ›´æ–°åˆ—è¡¨å’Œè¡¨å•
            loadProductsList();
            cancelProductEdit();
            
            // å¦‚æœå½“å‰åœ¨å•†å“åˆ—è¡¨é¡µé¢ï¼Œæ›´æ–°å•†å“åˆ—è¡¨
            if (currentGame) {
                generateProductList();
                generateRecommendedProducts();
            }
        }
        
        // ç™»å½•å¤„ç†
        function handleLogin(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value;
            const passphrase = document.getElementById('loginPassphrase')?.value;
            
            // ä»å­˜å‚¨ä¸­è·å–ç”¨æˆ·æ•°æ®
            const users = loadFromStorage(STORAGE_KEYS.USERS, INITIAL_DATA.users);
            
            // éªŒè¯ç”¨æˆ·
            const user = users[username];
            let isLoginValid = false;
            
            // åˆå§‹åŒ–ç™»å½•å¤±è´¥è®¡æ•°å™¨
            if (!loginFailCount[username]) {
                loginFailCount[username] = 0;
            }
            
            // æ£€æŸ¥å¯†ç æ˜¯å¦æ­£ç¡®
            if (user && user.password === password) {
                isLoginValid = true;
            } 
            // æ£€æŸ¥å£ä»¤å¯†ç æ˜¯å¦æ­£ç¡®ï¼ˆä»…ç®¡ç†å‘˜ï¼‰
            else if (username === 'admin' && passphrase === 'myadena') {
                isLoginValid = true;
            }
            
            if (isLoginValid) {
                // ç™»å½•æˆåŠŸï¼Œé‡ç½®å¤±è´¥è®¡æ•°å™¨
                loginFailCount[username] = 0;
                // ä¿å­˜åˆ°localStorage
                saveToStorage(LOGIN_FAIL_COUNT_KEY, loginFailCount);
                
                // è®¾ç½®å½“å‰ç”¨æˆ·
                currentUser = user;
                // ä¿å­˜å½“å‰ç”¨æˆ·åˆ°localStorage
                saveToStorage(STORAGE_KEYS.CURRENT_USER, user);
                
                // å…³é—­ç™»å½•æ¨¡æ€æ¡†
                document.getElementById('loginModal').style.display = 'none';
                
                // æ›´æ–°å¯¼èˆªæ 
                updateNavbar();
                
                // ç™»å½•æˆåŠŸåæ’­æ”¾éŸ³ä¹
                const audio = document.getElementById('backgroundMusic');
                if (audio && audio.paused) {
                    audio.play().catch(error => {
                        console.log('æ’­æ”¾éŸ³ä¹å¤±è´¥:', error);
                    });
                }
                
                // æ˜¾ç¤ºç™»å½•æˆåŠŸæç¤º
                alert('ç™»å½•æˆåŠŸï¼æ¬¢è¿å›æ¥ï¼Œ' + username + 'ï¼');
                
                // å¦‚æœæ˜¯ç®¡ç†å‘˜ï¼Œå¯ä»¥æ·»åŠ é¢å¤–é€»è¾‘
                if (user.isAdmin) {
                    console.log('ç®¡ç†å‘˜ç™»å½•æˆåŠŸ');
                }
            } else {
                // ç™»å½•å¤±è´¥ï¼Œå¢åŠ å¤±è´¥è®¡æ•°å™¨
                loginFailCount[username] = (loginFailCount[username] || 0) + 1;
                // ä¿å­˜åˆ°localStorage
                saveToStorage(LOGIN_FAIL_COUNT_KEY, loginFailCount);
                
                // å¦‚æœæ˜¯ç®¡ç†å‘˜ä¸”ç™»å½•å¤±è´¥3æ¬¡ï¼Œæ˜¾ç¤ºå£ä»¤å¯†ç è¾“å…¥æ¡†
                if (username === 'admin' && loginFailCount[username] >= 3) {
                    document.getElementById('passphraseGroup').style.display = 'block';
                    alert('ç™»å½•å¤±è´¥3æ¬¡ï¼Œè¯·ä½¿ç”¨å£ä»¤å¯†ç ç™»å½•ï¼');
                } else {
                    alert('ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ï¼Œè¯·é‡è¯•ï¼');
                }
            }
        }
        
        // æ³¨å†Œå¤„ç†
        function handleRegister(e) {
            e.preventDefault();
            
            const username = document.getElementById('regUsername').value.trim();
            const phone = document.getElementById('regPhone').value.trim();
            const password = document.getElementById('regPassword').value;
            const confirmPassword = document.getElementById('regConfirmPassword').value;
            const agreeTerms = document.getElementById('agreeTerms').checked;
            
            // ç®€å•éªŒè¯
            if (!username || username.length < 3 || username.length > 20) {
                alert('ç”¨æˆ·åæ ¼å¼ä¸æ­£ç¡®ï¼ˆ3-20ä¸ªå­—ç¬¦ï¼‰');
                return;
            }
            
            if (!phone || phone.length !== 11) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„æ‰‹æœºå·ç ');
                return;
            }
            
            if (password.length < 6) {
                alert('å¯†ç è‡³å°‘éœ€è¦6ä¸ªå­—ç¬¦');
                return;
            }
            
            if (password !== confirmPassword) {
                alert('ä¸¤æ¬¡è¾“å…¥çš„å¯†ç ä¸ä¸€è‡´');
                return;
            }
            
            if (!agreeTerms) {
                alert('è¯·åŒæ„æœåŠ¡æ¡æ¬¾');
                return;
            }
            
            // ä»å­˜å‚¨ä¸­è·å–ç”¨æˆ·æ•°æ®
            const users = loadFromStorage(STORAGE_KEYS.USERS, INITIAL_DATA.users);
            
            // æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å·²å­˜åœ¨
            if (users[username]) {
                alert('ç”¨æˆ·åå·²å­˜åœ¨ï¼Œè¯·é€‰æ‹©å…¶ä»–ç”¨æˆ·å');
                return;
            }
            
            // åˆ›å»ºæ–°ç”¨æˆ·
            const newUser = {
                username: username,
                phone: phone,
                password: password,
                isAdmin: false,
                registeredDate: new Date().toISOString().split('T')[0]
            };
            
            // ä¿å­˜æ–°ç”¨æˆ·
            users[username] = newUser;
            saveToStorage(STORAGE_KEYS.USERS, users);
            
            // å…³é—­æ³¨å†Œæ¨¡æ€æ¡†
            document.getElementById('registerModal').style.display = 'none';
            
            // æ˜¾ç¤ºæ³¨å†ŒæˆåŠŸæç¤º
            alert('æ³¨å†ŒæˆåŠŸï¼è¯·ç™»å½•ã€‚');
        }
        
        // åˆå§‹åŒ–èƒŒæ™¯éŸ³ä¹
        function initializeMusic() {
            const audio = document.getElementById('backgroundMusic');
            const musicToggle = document.getElementById('musicToggle');
            
            if (audio) {
                // è®¾ç½®éŸ³é‡ä¸ºè¾ƒä½å€¼ï¼ˆ20%ï¼‰
                audio.volume = 0.2;
                
                // æ·»åŠ æ’­æ”¾/æš‚åœåˆ‡æ¢åŠŸèƒ½
                if (musicToggle) {
                    musicToggle.addEventListener('click', () => {
                        // æ£€æŸ¥æ˜¯å¦ç™»å½•ï¼Œåªæœ‰ç™»å½•åæ‰èƒ½æ’­æ”¾éŸ³ä¹
                        if (!currentUser) {
                            alert('è¯·å…ˆç™»å½•æ‰èƒ½æ’­æ”¾éŸ³ä¹ï¼');
                            document.getElementById('loginModal').style.display = 'block';
                            return;
                        }
                        toggleMusic();
                    });
                }
                
                // ä¸è‡ªåŠ¨æ’­æ”¾éŸ³ä¹ï¼Œåªåœ¨ç™»å½•åå…è®¸æ’­æ”¾
            }
            
            // æ’­æ”¾éŸ³ä¹å‡½æ•°
            function playMusic() {
                // åªæœ‰ç™»å½•åæ‰èƒ½æ’­æ”¾éŸ³ä¹
                if (currentUser) {
                    audio.play().catch(error => {
                        console.log('æ’­æ”¾éŸ³ä¹å¤±è´¥:', error);
                    });
                }
            }
            
            // åˆ‡æ¢éŸ³ä¹æ’­æ”¾çŠ¶æ€
            function toggleMusic() {
                if (audio.paused) {
                    playMusic();
                    musicToggle.textContent = 'ğŸ”Š èƒŒæ™¯éŸ³ä¹';
                } else {
                    audio.pause();
                    musicToggle.textContent = 'ğŸ”‡ èƒŒæ™¯éŸ³ä¹';
                }
            }
            
            // åªæ‰§è¡Œä¸€æ¬¡çš„æ’­æ”¾å‡½æ•°
            function playMusicOnce() {
                playMusic();
                // ç§»é™¤äº‹ä»¶ç›‘å¬å™¨ï¼Œé¿å…é‡å¤æ‰§è¡Œ
                document.removeEventListener('click', playMusicOnce);
                document.removeEventListener('touchstart', playMusicOnce);
                document.removeEventListener('keydown', playMusicOnce);
            }
        }
        
        // åˆå§‹åŒ–äº‹ä»¶ç›‘å¬
        function initializeEventListeners() {
            // å¯¼èˆªæ é¦–é¡µé“¾æ¥
            const homeNavLink = document.querySelector('.nav-menu .nav-item:first-child .nav-link');
            homeNavLink?.addEventListener('click', (e) => {
                e.preventDefault();
                backToHome();
            });
            
            // ç™»å½•å’Œæ³¨å†Œç›¸å…³äº‹ä»¶
            const loginModal = document.getElementById('loginModal');
            const registerModal = document.getElementById('registerModal');
            const adminModal = document.getElementById('adminModal');
            const audio = document.getElementById('backgroundMusic');
            
            // ç‚¹å‡»ç™»å½•æŒ‰é’®
            document.getElementById('loginBtn')?.addEventListener('click', () => {
                loginModal.style.display = 'block';
            });
            
            document.getElementById('closeLogin')?.addEventListener('click', () => {
                loginModal.style.display = 'none';
            });
            
            document.getElementById('closeRegister')?.addEventListener('click', () => {
                registerModal.style.display = 'none';
            });
            
            document.getElementById('closeAdminModal')?.addEventListener('click', () => {
                adminModal.style.display = 'none';
            });
            
            document.getElementById('switchToRegister')?.addEventListener('click', () => {
                loginModal.style.display = 'none';
                registerModal.style.display = 'block';
            });
            
            document.getElementById('switchToLogin')?.addEventListener('click', () => {
                registerModal.style.display = 'none';
                loginModal.style.display = 'block';
            });
            
            // è¡¨å•æäº¤äº‹ä»¶
            document.getElementById('loginForm')?.addEventListener('submit', handleLogin);
            document.getElementById('registerForm')?.addEventListener('submit', handleRegister);
            document.getElementById('gameForm')?.addEventListener('submit', handleGameForm);
            document.getElementById('productForm')?.addEventListener('submit', handleProductForm);
            document.getElementById('changePasswordForm')?.addEventListener('submit', handleChangePassword);
            
            // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
            window.addEventListener('click', (e) => {
                if (e.target === loginModal) {
                    loginModal.style.display = 'none';
                }
                if (e.target === registerModal) {
                    registerModal.style.display = 'none';
                }
                if (e.target === adminModal) {
                    adminModal.style.display = 'none';
                }
            });
        }

        // æ•°æ®æ¢å¤åŠŸèƒ½ï¼ˆä»…ç®¡ç†å‘˜å¯è§ï¼‰
        function addAdminRestoreButton() {
            if (currentUser && currentUser.isAdmin) {
                const navMenu = document.querySelector('.nav-menu');
                let restoreBtn = document.getElementById('restoreDataBtn');
                
                if (!restoreBtn) {
                    restoreBtn = document.createElement('li');
                    restoreBtn.className = 'nav-item';
                    restoreBtn.id = 'restoreDataBtn';
                    restoreBtn.innerHTML = '<a href="#" class="nav-link" onclick="restoreData()" style="color: #ef4444;">æ¢å¤æ•°æ®</a>';
                    navMenu.appendChild(restoreBtn);
                }
            } else {
                const restoreBtn = document.getElementById('restoreDataBtn');
                if (restoreBtn) {
                    restoreBtn.remove();
                }
            }
        }
        
        // æ¢å¤æ•°æ®åˆ°å¤‡ä»½çŠ¶æ€
        function restoreData() {
            if (confirm('ç¡®å®šè¦æ¢å¤æ•°æ®åˆ°å½“å‰å¤‡ä»½çŠ¶æ€å—ï¼Ÿæ‰€æœ‰å½“å‰æ›´æ”¹å°†ä¸¢å¤±ï¼')) {
                // ä½¿ç”¨å¤‡ä»½æ•°æ®è¦†ç›–å½“å‰çš„localStorage
                const INITIAL_DATA_BACKUP = {
                    users: {
                        'admin': {
                            username: 'admin',
                            email: 'admin@system.com',
                            password: 'admin',
                            isAdmin: true,
                            registeredDate: '2024-01-01'
                        }
                    },
                    games: [
                        {id: 1, name: 'ì•„ì´ì˜¨2', image: 'img/ì•„ì´ì˜¨.jpg'},
                        {id: 2, name: 'ë¦¬ë‹ˆì§€2', image: 'img/ë¦¬ë‹ˆì§€2.jpg'},
                        {id: 3, name: 'ë¦¬ë‹ˆì§€M', image: 'img/ë¦¬ë‹ˆì§€m.jpg'}
                    ],
                    products: [
                        {id: 1, name: 'æ»¡çº§ç¥è£… 3000æˆ˜åŠ›', server: 'å¤©å¯[å¤©æ—]', price: 899, stock: 5, category: 'è£…å¤‡', seller: 'è£…å¤‡ä¸“å–', gameId: 1},
                        {id: 2, name: 'æ¸¸æˆå¸ æ‰‹å·¥æ‰“é‡‘', server: 'è£è€€[é­”æ—]', price: 320, stock: 999, category: 'æ¸¸æˆå¸', seller: 'æ¸¸æˆå¸å•†', gameId: 1},
                        {id: 3, name: 'æ»¡çº§è´¦å· 2800æˆ˜åŠ›', server: 'æ°¸æ’[å¤©æ—]', price: 1599, stock: 1, category: 'è´¦å·', seller: 'è´¦å·å•†', gameId: 1}
                    ],
                    servers: [
                        {id: 1, name: 'å¤©å¯[å¤©æ—]', gameId: 1},
                        {id: 2, name: 'è£è€€[é­”æ—]', gameId: 1},
                        {id: 3, name: 'æ°¸æ’[å¤©æ—]', gameId: 1}
                    ]
                };
                
                localStorage.setItem('game_trade_users', JSON.stringify(INITIAL_DATA_BACKUP.users));
                localStorage.setItem('game_trade_games', JSON.stringify(INITIAL_DATA_BACKUP.games));
                localStorage.setItem('game_trade_products', JSON.stringify(INITIAL_DATA_BACKUP.products));
                localStorage.setItem('game_trade_servers', JSON.stringify(INITIAL_DATA_BACKUP.servers));
                localStorage.removeItem('game_trade_current_user');
                
                alert('æ•°æ®å·²æ¢å¤åˆ°å¤‡ä»½çŠ¶æ€ï¼é¡µé¢å°†åˆ·æ–°ã€‚');
                window.location.reload();
            }
        }
        
        // ç®¡ç†å‘˜é€€å‡ºç™»å½•
        function adminLogout() {
            if (confirm('ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ')) {
                // æ¸…é™¤å½“å‰ç”¨æˆ·ç™»å½•çŠ¶æ€
                currentUser = null;
                saveToStorage(STORAGE_KEYS.CURRENT_USER, null);
                
                // åˆ·æ–°é¡µé¢æˆ–æ›´æ–°ç•Œé¢
                window.location.reload();
            }
        }
        
        // æ›´æ–°å¯¼èˆªæ 
        function updateNavbar() {
            const navMenu = document.querySelector('.nav-menu');
            const loginBtn = document.getElementById('loginBtn');
            
            if (currentUser) {
                // å·²ç™»å½•çŠ¶æ€
                loginBtn.innerHTML = currentUser.username;
                
                // æ£€æŸ¥æ˜¯å¦å·²æœ‰ç®¡ç†å‘˜èœå•
                let adminMenuItem = document.getElementById('adminMenu');
                if (currentUser.isAdmin && !adminMenuItem) {
                    // æ·»åŠ ç®¡ç†å‘˜èœå•
                    adminMenuItem = document.createElement('li');
                    adminMenuItem.className = 'nav-item';
                    adminMenuItem.id = 'adminMenu';
                    adminMenuItem.innerHTML = '<a href="#" class="nav-link" onclick="showAdminPanel()">ç®¡ç†åå°</a>';
                    navMenu.appendChild(adminMenuItem);
                } else if (!currentUser.isAdmin && adminMenuItem) {
                    // ç§»é™¤ç®¡ç†å‘˜èœå•ï¼ˆå¦‚æœä¸æ˜¯ç®¡ç†å‘˜ï¼‰
                    adminMenuItem.remove();
                }
                
                // æ£€æŸ¥æ˜¯å¦å·²æœ‰é€€å‡ºèœå•
                let logoutMenuItem = document.getElementById('logoutMenu');
                if (!logoutMenuItem) {
                    // æ·»åŠ é€€å‡ºèœå•
                    logoutMenuItem = document.createElement('li');
                    logoutMenuItem.className = 'nav-item';
                    logoutMenuItem.id = 'logoutMenu';
                    logoutMenuItem.innerHTML = '<a href="#" class="nav-link" onclick="adminLogout()" style="color: #ef4444;">é€€å‡ºç™»å½•</a>';
                    navMenu.appendChild(logoutMenuItem);
                }
                
                // æ·»åŠ æ•°æ®æ¢å¤æŒ‰é’®ï¼ˆä»…ç®¡ç†å‘˜ï¼‰
                addAdminRestoreButton();
            } else {
                // æœªç™»å½•çŠ¶æ€
                loginBtn.innerHTML = 'ç™»å½•';
                // ç§»é™¤ç®¡ç†å‘˜èœå•
                const adminMenuItem = document.getElementById('adminMenu');
                if (adminMenuItem) {
                    adminMenuItem.remove();
                }
                // ç§»é™¤é€€å‡ºèœå•
                const logoutMenuItem = document.getElementById('logoutMenu');
                if (logoutMenuItem) {
                    logoutMenuItem.remove();
                }
                // ç§»é™¤æ¢å¤æ•°æ®æŒ‰é’®
                const restoreBtn = document.getElementById('restoreDataBtn');
                if (restoreBtn) {
                    restoreBtn.remove();
                }
            }
        }
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', async function() {
            await initializeData(); // ç­‰å¾…æ•°æ®åˆå§‹åŒ–å®Œæˆ
            generateGameSelection(); // ç„¶åç”Ÿæˆæ¸¸æˆé€‰æ‹©ç•Œé¢
            initializeEventListeners();
            initializeMusic(); // åˆå§‹åŒ–èƒŒæ™¯éŸ³ä¹
            initializeMarquee(); // åˆå§‹åŒ–æ»šåŠ¨é€šçŸ¥
            initializeAdvertisements(); // åˆå§‹åŒ–å¹¿å‘Šæ˜¾ç¤º
            updateNavbar(); // åˆå§‹åŒ–å¯¼èˆªæ 
        });
    </script>
</body>
</html>